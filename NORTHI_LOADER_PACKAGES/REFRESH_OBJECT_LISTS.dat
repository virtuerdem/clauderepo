
  CREATE OR REPLACE EDITIONABLE PACKAGE BODY "NORTHI_LOADER"."REFRESH_OBJECT_LISTS" AS 
 
 PROCEDURE REFRESH_SGSN_OBJECTS
 AS
CUR_DATE DATE;
MAX_DATE DATE;
state varchar2(200);
errm varchar2(4000);
errcode number; 

BEGIN

STATE:= '1';    

/*
     MERGE  INTO NORTHI_DATA.LIST_PAPU_LAC  A USING
    (
        SELECT DISTINCT DECODE(INT_ID,184511,79,184512,80,239,15858,184513,15878,INT_ID) SGSN_ID,TO_NUMBER(DECODE(INT_ID,184511,79,184512,80,239,15858,184513,15878,INT_ID)||PAPU_INDEX) PAPU_ID ,LAC LAC_ID,TO_NUMBER(DECODE(INT_ID,184511,79,184512,80,239,15858,184513,15878,INT_ID)||PAPU_INDEX||LAC) NETWORK_ID,'LAC-'||TO_CHAR(LAC) LAC_NAME
        FROM NORTHI_PARSER.P_SGSN_RAUM
        WHERE PERIOD_START_TIME BETWEEN SYSDATE-3 AND SYSDATE
        --AND PAPU_INDEX>16
        AND RAC<255
    ) E ON (A.NETWORK_ID=E.NETWORK_ID)
    WHEN NOT MATCHED THEN
    INSERT (A.SGSN_ID,A.PAPU_ID,A.LAC_ID,A.NETWORK_ID,A.LAC_NAME)
    VALUES (E.SGSN_ID,E.PAPU_ID,E.LAC_ID,E.NETWORK_ID,E.LAC_NAME);
    COMMIT;


STATE:= '2';    

    MERGE  INTO NORTHI_DATA.LIST_PAPU_RAC A USING
    (
        SELECT DISTINCT DECODE(INT_ID,184511,79,184512,80,239,15858,184513,15878,INT_ID) SGSN_ID,TO_NUMBER(DECODE(INT_ID,184511,79,184512,80,239,15858,184513,15878,INT_ID)||PAPU_INDEX||LAC) LAC_ID,RAC RAC_ID,TO_NUMBER(DECODE(INT_ID,184511,79,184512,80,239,15858,184513,15878,INT_ID)||PAPU_INDEX||LAC||RAC) NETWORK_ID,'RAC-'||TO_CHAR(RAC) RAC_NAME
        FROM NORTHI_PARSER.P_SGSN_RAUM
        WHERE PERIOD_START_TIME BETWEEN SYSDATE-3 AND SYSDATE
        --AND PAPU_INDEX>16
        AND RAC<255
    ) E ON (A.NETWORK_ID=E.NETWORK_ID)
    WHEN NOT MATCHED THEN
    INSERT (A.SGSN_ID,A.LAC_ID,A.RAC_ID,A.NETWORK_ID,A.RAC_NAME)
    VALUES (E.SGSN_ID,E.LAC_ID,E.RAC_ID,E.NETWORK_ID,E.RAC_NAME);
    COMMIT;
    
STATE:= '3';

    MERGE  INTO NORTHI_DATA.LIST_PAPU A USING
    (  
        SELECT DISTINCT DECODE(INT_ID,184511,79,184512,80,239,15858,184513,15878,INT_ID) SGSN_ID,PAPU_INDEX PAPU_ID,TO_NUMBER(DECODE(INT_ID,184511,79,184512,80,239,15858,184513,15878,INT_ID)||PAPU_INDEX) NETWORK_ID,'PAPU-'||TO_CHAR(PAPU_INDEX) PAPU_NAME
        FROM NORTHI_PARSER.P_SGSN_DATA
        WHERE PERIOD_START_TIME BETWEEN SYSDATE-3 AND SYSDATE 
        AND PAPU_INDEX<=16    
    )E ON (A.NETWORK_ID=E.NETWORK_ID)
    WHEN NOT MATCHED THEN
    INSERT (A.SGSN_ID,A.PAPU_ID,A.NETWORK_ID,A.PAPU_NAME)
    VALUES (E.SGSN_ID,E.PAPU_ID,E.NETWORK_ID,E.PAPU_NAME);
    COMMIT;

STATE:= '4';
    
    MERGE INTO NORTHI_DATA.LIST_NSEI A USING
    (  
        SELECT DISTINCT DECODE(INT_ID,184511,79,184512,80,239,15858,184513,15878,INT_ID) SGSN_ID,TO_NUMBER(DECODE(INT_ID,184511,79,184512,80,239,15858,184513,15878,INT_ID)||PAPU_INDEX) PAPU_ID,NSEI NSEI_ID,TO_NUMBER(DECODE(INT_ID,184511,79,184512,80,239,15858,184513,15878,INT_ID)||PAPU_INDEX||'0'||NSEI) NETWORK_ID,'NSEI-'||TO_CHAR(NSEI) NSEI_NAME
        FROM NORTHI_PARSER.P_SGSN_NSVC_DATA
        WHERE PERIOD_START_TIME BETWEEN SYSDATE-3 AND SYSDATE
        AND PAPU_INDEX<=16    
    )E ON (A.NETWORK_ID=E.NETWORK_ID)
    WHEN NOT MATCHED THEN
    INSERT (A.SGSN_ID,A.PAPU_ID,A.NSEI_ID,A.NETWORK_ID,A.NSEI_NAME)
    VALUES (E.SGSN_ID,E.PAPU_ID,E.NSEI_ID,E.NETWORK_ID,E.NSEI_NAME);
    COMMIT;
    
STATE:= '5';    
    MERGE  INTO NORTHI_DATA.LIST_NSVCI A USING
    (  
        SELECT DISTINCT DECODE(INT_ID,184511,79,184512,80,239,15858,184513,15878,INT_ID) SGSN_ID,TO_NUMBER(DECODE(INT_ID,184511,79,184512,80,239,15858,184513,15878,INT_ID)||PAPU_INDEX) PAPU_ID,TO_NUMBER(DECODE(INT_ID,184511,79,184512,80,239,15858,184513,15878,INT_ID)||PAPU_INDEX||'0'||NSEI) NSEI_ID,NSVCI NSVCI_ID,TO_NUMBER(DECODE(INT_ID,184511,79,184512,80,239,15858,184513,15878,INT_ID)||PAPU_INDEX||'0'||NSEI||'0'||NSVCI) NETWORK_ID,'NSVCI-'||TO_CHAR(NSVCI) NSVCI_NAME
        FROM NORTHI_PARSER.P_SGSN_NSVC_DATA
        WHERE PERIOD_START_TIME BETWEEN SYSDATE-3 AND SYSDATE 
    )E ON (A.NETWORK_ID=E.NETWORK_ID)
    WHEN NOT MATCHED THEN
    INSERT (A.SGSN_ID,A.PAPU_ID,A.NSEI_ID,A.NSVCI_ID,A.NETWORK_ID,A.NSVCI_NAME)
    VALUES (E.SGSN_ID,E.PAPU_ID,E.NSEI_ID,E.NSVCI_ID,E.NETWORK_ID,E.NSVCI_NAME);
    COMMIT;

STATE:= '6';    
    MERGE  INTO NORTHI_DATA.LIST_LAC  A USING
    (
        SELECT DISTINCT DECODE(INT_ID,184511,79,184512,80,239,15858,184513,15878,INT_ID) SGSN_ID,LAC LAC_ID,TO_NUMBER(DECODE(INT_ID,184511,79,184512,80,239,15858,184513,15878,INT_ID)||'0'||LAC) NETWORK_ID,'LAC-'||TO_CHAR(LAC) LAC_NAME
        FROM NORTHI_PARSER.P_SGSN_MOBILITY_MANAGEMENT
        WHERE PERIOD_START_TIME BETWEEN SYSDATE-3 AND SYSDATE
        AND PAPU_INDEX>16
        AND RAC<255
    ) E ON (A.NETWORK_ID=E.NETWORK_ID)
    WHEN NOT MATCHED THEN
    INSERT (A.SGSN_ID,A.LAC_ID,A.NETWORK_ID,A.LAC_NAME)
    VALUES (E.SGSN_ID,E.LAC_ID,E.NETWORK_ID,E.LAC_NAME);
    COMMIT;

STATE:= '7';    
    MERGE  INTO NORTHI_DATA.LIST_RAC A USING
    (
        SELECT DISTINCT DECODE(INT_ID,184511,79,184512,80,239,15858,184513,15878,INT_ID)SGSN_ID,TO_NUMBER(DECODE(INT_ID,184511,79,184512,80,239,15858,184513,15878,INT_ID)||'0'||LAC) LAC_ID,RAC RAC_ID,TO_NUMBER(DECODE(INT_ID,184511,79,184512,80,239,15858,184513,15878,INT_ID)||'0'||LAC||RAC) NETWORK_ID,'RAC-'||TO_CHAR(RAC) RAC_NAME
        FROM NORTHI_PARSER.P_SGSN_MOBILITY_MANAGEMENT
        WHERE PERIOD_START_TIME BETWEEN SYSDATE-3 AND SYSDATE
        AND PAPU_INDEX>16
        AND RAC<255
    ) E ON (A.NETWORK_ID=E.NETWORK_ID)
    WHEN NOT MATCHED THEN
    INSERT (A.SGSN_ID,A.LAC_ID,A.RAC_ID,A.NETWORK_ID,A.RAC_NAME)
    VALUES (E.SGSN_ID,E.LAC_ID,E.RAC_ID,E.NETWORK_ID,E.RAC_NAME);
    COMMIT;

STATE:= '8';    
    MERGE  INTO NORTHI_DATA.LIST_CI A USING
    (
        SELECT DISTINCT DECODE(INT_ID,184511,79,184512,80,239,15858,184513,15878,INT_ID) SGSN_ID,TO_NUMBER(DECODE(INT_ID,184511,79,184512,80,239,15858,184513,15878,INT_ID)||'0'||LAC) LAC_ID,
        TO_NUMBER(DECODE(INT_ID,184511,79,184512,80,239,15858,184513,15878,INT_ID)||'0'||LAC||RAC) RAC_ID ,CI CI_ID,TO_NUMBER(DECODE(INT_ID,184511,79,184512,80,239,15858,184513,15878,INT_ID)||'0'||LAC||RAC||CI) NETWORK_ID,'CI-'||TO_CHAR(CI) CI_NAME
        FROM NORTHI_PARSER.P_SGSN_MOBILITY_MANAGEMENT
        WHERE PERIOD_START_TIME BETWEEN SYSDATE-3 AND SYSDATE
        AND PAPU_INDEX>16
        AND RAC<255
    ) E ON (A.NETWORK_ID=E.NETWORK_ID)
    WHEN NOT MATCHED THEN
    INSERT (A.SGSN_ID,A.LAC_ID,A.RAC_ID,A.CI_ID,A.NETWORK_ID,A.CI_NAME)
    VALUES (E.SGSN_ID,E.LAC_ID,E.RAC_ID,E.CI_ID,E.NETWORK_ID,E.CI_NAME);
    COMMIT;
    
STATE:= '9';    
    MERGE  INTO NORTHI_DATA.LIST_OBJECT A USING
    (
        SELECT DISTINCT DECODE(INT_ID,184511,79,184512,80,239,15858,184513,15878,INT_ID) SGSN_ID,DECODE(INT_ID,184511,79,184512,80,239,15858,184513,15878,INT_ID)||'000'||DECODE(OBJECT_NAME,'PAPU',1,'SMMU',2,'MCHU',3,'OMU',4,'GBU',5,'IPPU',6) OBJECT_ID,OBJECT_NAME,DECODE(INT_ID,184511,79,184512,80,239,15858,184513,15878,INT_ID)||'000'||DECODE(OBJECT_NAME,'PAPU',1,'SMMU',2,'MCHU',3,'OMU',4,'GBU',5,'IPPU',6)||'0'||OBJECT_INDEX OBJECT_INDEX_ID,'Obj-'||OBJECT_INDEX OBJECT_INDEX_NAME
        FROM NORTHI_PARSER.P_SGSN_LOAD
        WHERE PERIOD_START_TIME BETWEEN SYSDATE-3 AND SYSDATE
    ) E ON (A.OBJECT_INDEX_ID=E.OBJECT_INDEX_ID)
    WHEN NOT MATCHED THEN
    INSERT ( A.SGSN_ID,A.OBJECT_ID,A.OBJECT_NAME,A.OBJECT_INDEX_ID,A.OBJECT_INDEX_NAME)
    VALUES ( E.SGSN_ID,E.OBJECT_ID,E.OBJECT_NAME,E.OBJECT_INDEX_ID,E.OBJECT_INDEX_NAME);
    
    COMMIT;

STATE:= '10';    
    MERGE  INTO NORTHI_DATA.LIST_MNC A USING
    (
        SELECT DISTINCT DECODE(INT_ID,184511,79,184512,80,239,15858,184513,15878,INT_ID) SGSN_ID,
        PAPU_INDEX,
        LAC LAC_ID,
        RAC RAC_ID ,
        MCC MCC_ID,
        MNC MNC_ID,
        DECODE(INT_ID,184511,79,184512,80,239,15858,184513,15878,INT_ID)||PAPU_INDEX||LAC||RAC||MCC||MNC NETWORK_ID ,
        'MNC_'|| MNC MNC_NAME
        FROM NORTHI_PARSER.P_SGSN_BPFC
        WHERE PERIOD_START_TIME BETWEEN SYSDATE-3 AND SYSDATE
        UNION ALL
        SELECT DISTINCT DECODE(INT_ID,184511,79,184512,80,239,15858,184513,15878,INT_ID) SGSN_ID,
        PAPU_INDEX,
        LAC LAC_ID,
        RAC RAC_ID ,
        MCC MCC_ID,
        MNC MNC_ID,
        DECODE(INT_ID,184511,79,184512,80,239,15858,184513,15878,INT_ID)||PAPU_INDEX||LAC||RAC||MCC||MNC NETWORK_ID ,
        'MNC_'|| MNC MNC_NAME
        FROM NORTHI_PARSER.P_SGSN_RAUS
        WHERE PERIOD_START_TIME BETWEEN SYSDATE-3 AND SYSDATE
    ) E ON (A.NETWORK_ID=E.NETWORK_ID)
    WHEN NOT MATCHED THEN
    INSERT (A.SGSN_ID,A.PAPU_INDEX,A.LAC_ID,A.RAC_ID,A.MCC_ID,A.MNC_ID, A.NETWORK_ID,A.MNC_NAME)
    VALUES (E.SGSN_ID,E.PAPU_INDEX,E.LAC_ID,E.RAC_ID,E.MCC_ID,E.MNC_ID, E.NETWORK_ID,E.MNC_NAME);
    COMMIT;

STATE:= '11';    
    MERGE  INTO NORTHI_DATA.LIST_IPPU A USING
    (
        SELECT DISTINCT DECODE(INT_ID,184511,79,184512,80,239,15858,184513,15878,INT_ID) SGSN_ID,
        IPPU_PHYSICAL_INDEX,
        DECODE(INT_ID,184511,79,184512,80,239,15858,184513,15878,INT_ID)||IPPU_PHYSICAL_INDEX NETWORK_ID ,
        'IPPU_'|| IPPU_PHYSICAL_INDEX IPPU_NAME
        FROM NORTHI_PARSER.P_SGSN_IPPU_DATA
        WHERE PERIOD_START_TIME BETWEEN SYSDATE-3 AND SYSDATE
    ) E ON (A.NETWORK_ID=E.NETWORK_ID)
    WHEN NOT MATCHED THEN
    INSERT (A.SGSN_ID,A.IPPU_PHYSICAL_INDEX,A.NETWORK_ID,A.IPPU_NAME)
    VALUES (E.SGSN_ID,E.IPPU_PHYSICAL_INDEX,E.NETWORK_ID,E.IPPU_NAME);
    COMMIT;

STATE:= '12';    
    MERGE  INTO NORTHI_DATA.LIST_IPPU_BT A USING
    (
        SELECT DISTINCT DECODE(INT_ID,184511,79,184512,80,239,15858,184513,15878,INT_ID) SGSN_ID,
        IPPU_PHYSICAL_INDEX,
        TRAFFIC_CLASS,
        BEARER_CLASS,
        DECODE(INT_ID,184511,79,184512,80,239,15858,184513,15878,INT_ID)||IPPU_PHYSICAL_INDEX||TRAFFIC_CLASS||BEARER_CLASS NETWORK_ID ,
        'BEARER_'|| BEARER_CLASS BEARER_NAME
        FROM NORTHI_PARSER.P_SGSN_IPPU_THROUGHPUT
        WHERE PERIOD_START_TIME BETWEEN SYSDATE-3 AND SYSDATE
    ) E ON (A.NETWORK_ID=E.NETWORK_ID)
    WHEN NOT MATCHED THEN
    INSERT (A.SGSN_ID,A.IPPU_PHYSICAL_INDEX,A.TRAFFIC_CLASS, A.BEARER_CLASS,A.NETWORK_ID,A.BEARER_NAME)
    VALUES (E.SGSN_ID,E.IPPU_PHYSICAL_INDEX,E.TRAFFIC_CLASS, E.BEARER_CLASS,E.NETWORK_ID,E.BEARER_NAME);
    COMMIT;

STATE:= '13';    
    MERGE  INTO NORTHI_DATA.LIST_IUSAC A USING
    (
        SELECT DISTINCT DECODE(INT_ID,184511,79,184512,80,239,15858,184513,15878,INT_ID) SGSN_ID,
        PAPU_INDEX,IU_RA_RNC_ID,IU_RA_LAC,RAC,IU_RA_MCC,IU_RA_MNC,SAC,IU_SA_LAC,IU_SA_MCC,IU_SA_MNC,
        DECODE(INT_ID,184511,79,184512,80,239,15858,184513,15878,INT_ID)||PAPU_INDEX||IU_RA_RNC_ID||IU_RA_LAC||RAC||IU_RA_MCC||IU_RA_MNC||SAC||IU_SA_LAC||IU_SA_MCC||IU_SA_MNC NETWORK_ID ,
        'IUSAC_'|| IU_SA_MNC IUSAC_NAME
        FROM NORTHI_PARSER.P_SGSN_IU_MOBILITY_MANAGEMENT
        WHERE PERIOD_START_TIME BETWEEN SYSDATE-3 AND SYSDATE
    ) E ON (A.NETWORK_ID=E.NETWORK_ID)
    WHEN NOT MATCHED THEN
    INSERT (A.SGSN_ID,A.PAPU_INDEX,A.IU_RA_RNC_ID,A.IU_RA_LAC,A.RAC,A.IU_RA_MCC,A.IU_RA_MNC,A.SAC,A.IU_SA_LAC,A.IU_SA_MCC,A.IU_SA_MNC,A.NETWORK_ID,A.IUSAC_NAME)
    VALUES (E.SGSN_ID,E.PAPU_INDEX,E.IU_RA_RNC_ID,E.IU_RA_LAC,E.RAC,E.IU_RA_MCC,E.IU_RA_MNC,E.SAC,E.IU_SA_LAC,E.IU_SA_MCC,E.IU_SA_MNC,E.NETWORK_ID,E.IUSAC_NAME);
    COMMIT;
    
STATE:= '14';
    MERGE  INTO NORTHI_DATA.LIST_IURAC A USING
    (
        SELECT DISTINCT DECODE(INT_ID,184511,79,184512,80,239,15858,184513,15878,INT_ID) SGSN_ID,
        PAPU_INDEX,IU_RA_RNC_ID,IU_RA_LAC,RAC,IU_RA_MCC,IU_RA_MNC,
        DECODE(INT_ID,184511,79,184512,80,239,15858,184513,15878,INT_ID)||PAPU_INDEX||IU_RA_RNC_ID||IU_RA_LAC||RAC||IU_RA_MCC||IU_RA_MNC NETWORK_ID ,
        'IURAC_'|| IU_RA_MCC IURAC_NAME
        FROM NORTHI_PARSER.P_SGSN_IU_RA_PAGING
        WHERE PERIOD_START_TIME BETWEEN SYSDATE-3 AND SYSDATE
    ) E ON (A.NETWORK_ID=E.NETWORK_ID)
    WHEN NOT MATCHED THEN
    INSERT (A.SGSN_ID,A.PAPU_INDEX,A.IU_RA_RNC_ID,A.IU_RA_LAC,A.RAC,A.IU_RA_MCC,A.IU_RA_MNC,A.NETWORK_ID,A.IURAC_NAME)
    VALUES (E.SGSN_ID,E.PAPU_INDEX,E.IU_RA_RNC_ID,E.IU_RA_LAC,E.RAC,E.IU_RA_MCC,E.IU_RA_MNC,E.NETWORK_ID,E.IURAC_NAME);
    COMMIT;
    
STATE:= '15';
    MERGE  INTO NORTHI_DATA.LIST_IURANAP A USING
    (
        SELECT DISTINCT DECODE(INT_ID,184511,79,184512,80,239,15858,184513,15878,INT_ID) SGSN_ID,
        MCC,MNC,RNC_ID,
        DECODE(INT_ID,184511,79,184512,80,239,15858,184513,15878,INT_ID)||MCC||MNC||RNC_ID  NETWORK_ID ,
        'RNC_'|| RNC_ID IURAC_NAME
        FROM NORTHI_PARSER.P_SGSN_IU_RANAP
        WHERE PERIOD_START_TIME BETWEEN SYSDATE-3 AND SYSDATE
    ) E ON (A.NETWORK_ID=E.NETWORK_ID)
    WHEN NOT MATCHED THEN
    INSERT (A.SGSN_ID,A.MCC,A.MNC,A.RNC_ID,A.NETWORK_ID,A.IURAC_NAME)
    VALUES (E.SGSN_ID,E.MCC,E.MNC,E.RNC_ID,E.NETWORK_ID,E.IURAC_NAME);
    COMMIT;
*/    
    EXCEPTION
         WHEN NO_DATA_FOUND THEN
           NULL;
         WHEN OTHERS THEN
         --UPDATE NORTHI_LOADER_PROCESS SET LOADER_STATE=3 WHERE TABLE_NAME=XTABLE_NAME AND DATA_DATE=XDATA_DATE AND VENDOR_ID=1;
        errm:=SQLERRM;
        errcode:=sqlCODE;
       INSERT INTO NORTHI.NORTHI_ERROR_LOG (USER_NAME, ERROR_CODE, ERROR_MSG,TABLE_NAME, DATE_TIME, PROCEDURE_NAME,SQLTEXT) 
                             VALUES (user     ,errCODE, ERRM  ,null     , sysdate  ,'NORTHI_LOADER.REFRESH_OBJECT_LISTS.REFRESH_SGSN_OBJECTS',state );
       COMMIT;
           raise;    
 END REFRESH_SGSN_OBJECTS;
 PROCEDURE REFRESH_GGSN_OBJECTS 
 AS
 BEGIN
   RETURN; -- ICINI MEVCUT EXADATADAN AL
 END REFRESH_GGSN_OBJECTS;   
 
 /*  PROCEDURE REFRESH_EGGSN_OBJECTS 
 AS
 BEGIN
    MERGE INTO NORTHI_DATA.EGGSN_LIST A USING 
    (
        SELECT DISTINCT  GGSN_NAME
        FROM NORTHI_PARSER.GGSNPDPCONTEXTSSTATSATTEMPTED
        WHERE DATA_DATE BETWEEN TRUNC(SYSDATE)-2 AND SYSDATE
    ) E
        ON ( A.GGSN_NAME=E.GGSN_NAME)
        WHEN NOT MATCHED THEN
        INSERT(A.GGSN_NAME)
        VALUES(E.GGSN_NAME);
    COMMIT;
   
     

    MERGE INTO NORTHI_DATA.EGGSN_APN_LIST A USING 
    (
        SELECT DISTINCT  GGSN_NAME,ENTRY_NO APN_ID,C00021 APN_NAME
        FROM NORTHI_PARSER.GGSNAPNSTATSTABLE
        WHERE DATA_DATE BETWEEN TRUNC(SYSDATE)-2 AND SYSDATE
    ) E
    ON ( A.GGSN_NAME=E.GGSN_NAME AND A.APN_ID=E.APN_ID AND A.APN_NAME=E.APN_NAME)
        WHEN NOT MATCHED THEN
        INSERT( A.GGSN_NAME, A.APN_ID,A.APN_NAME)
        VALUES( E.GGSN_NAME , E.APN_ID,E.APN_NAME);
    COMMIT;

   
        
     MERGE INTO NORTHI_DATA.EGGSN_L2TP_LIST  A USING
    ( 
        SELECT DISTINCT GGSN_NAME,
        ENTRY_NO, 
        SUBSTR(C00130,INSTR(C00130,'.',-1)+1) L2REMOTEIP,
         C00122 L2LOCALTID
        FROM NORTHI_PARSER.GGSNL2TPTUNNELSTATSTABLE
        WHERE DATA_DATE BETWEEN TRUNC(SYSDATE)-2 AND SYSDATE
    ) E
    ON (A.GGSN_NAME=E.GGSN_NAME AND A.ENTRY_NO=E.ENTRY_NO AND A.L2REMOTEIP=E.L2REMOTEIP AND A.L2LOCALTID=E.L2LOCALTID)
        WHEN NOT MATCHED THEN
        INSERT(A.GGSN_NAME, A.ENTRY_NO, A.L2REMOTEIP , A.L2LOCALTID)
        VALUES(E.GGSN_NAME, E.ENTRY_NO, E.L2REMOTEIP,  E.L2LOCALTID);
    COMMIT;   
        
       
     MERGE INTO NORTHI_DATA.EGGSN_APN_RAD_AUTH_LIST  A USING
    ( 
        SELECT DISTINCT  GGSN_NAME,
        ENTRY_NO,
        SUBSTR(ENTRY_NO,1,INSTR(ENTRY_NO,'.')-1) GGSNAPNINDEX, 
        SUBSTR(ENTRY_NO,INSTR(ENTRY_NO,'.',-1)+1) GGSNAPNRADIUSAUTHSERVERINDEX
        FROM NORTHI_PARSER.GGSNAPNRADIUSAUTHSERVERSSTATS
        WHERE DATA_DATE BETWEEN TRUNC(SYSDATE)-2 AND SYSDATE
    ) E
    ON (A.GGSN_NAME=E.GGSN_NAME AND A.ENTRY_NO=E.ENTRY_NO AND A.GGSNAPNINDEX=E.GGSNAPNINDEX AND A.GGSNAPNRADIUSAUTHSERVERINDEX=E.GGSNAPNRADIUSAUTHSERVERINDEX)
        WHEN NOT MATCHED THEN
        INSERT(A.GGSN_NAME, A.ENTRY_NO, A.GGSNAPNINDEX, A.GGSNAPNRADIUSAUTHSERVERINDEX)
        VALUES(E.GGSN_NAME, E.ENTRY_NO, E.GGSNAPNINDEX, E.GGSNAPNRADIUSAUTHSERVERINDEX);
    COMMIT; 


    MERGE INTO NORTHI_DATA.EGGSN_APN_RAD_ACCT_LIST  A USING
    ( 
        SELECT DISTINCT  GGSN_NAME,
        ENTRY_NO,
        SUBSTR(ENTRY_NO,1,INSTR(ENTRY_NO,'.')-1) GGSNAPNINDEX, 
        SUBSTR(ENTRY_NO,INSTR(ENTRY_NO,'.',-1)+1) GGSNAPNRADIUSACCTSERVERINDEX
        FROM NORTHI_PARSER.GGSNAPNRADIUSACCTSERVERSSTATS
        WHERE DATA_DATE BETWEEN TRUNC(SYSDATE)-2 AND SYSDATE
    ) E
    ON (A.GGSN_NAME=E.GGSN_NAME AND A.ENTRY_NO=E.ENTRY_NO AND A.GGSNAPNINDEX=E.GGSNAPNINDEX AND A.GGSNAPNRADIUSACCTSERVERINDEX=E.GGSNAPNRADIUSACCTSERVERINDEX)
        WHEN NOT MATCHED THEN
        INSERT(A.GGSN_NAME, A.ENTRY_NO, A.GGSNAPNINDEX, A.GGSNAPNRADIUSACCTSERVERINDEX)
        VALUES(E.GGSN_NAME, E.ENTRY_NO, E.GGSNAPNINDEX, E.GGSNAPNRADIUSACCTSERVERINDEX);
    COMMIT; 


    MERGE INTO NORTHI_DATA.EGGSN_APN_FBC_CCAS_LIST  A USING
    ( 
        SELECT DISTINCT GGSN_NAME,
        ENTRY_NO,
        SUBSTR(ENTRY_NO,1,INSTR(ENTRY_NO,'.')-1) GGSNAPNINDEX, 
        SUBSTR(ENTRY_NO,INSTR(ENTRY_NO,'.',-1)+1) GGSNCCASINDEX
        FROM NORTHI_PARSER.GGSNAPNFBCCCASSTATSTABLE
        WHERE DATA_DATE BETWEEN TRUNC(SYSDATE)-2 AND SYSDATE
    ) E
    ON (A.GGSN_NAME=E.GGSN_NAME AND A.ENTRY_NO=E.ENTRY_NO AND A.GGSNAPNINDEX=E.GGSNAPNINDEX AND A.GGSNCCASINDEX=E.GGSNCCASINDEX)
        WHEN NOT MATCHED THEN
        INSERT(A.GGSN_NAME, A.ENTRY_NO, A.GGSNAPNINDEX, A.GGSNCCASINDEX)
        VALUES(E.GGSN_NAME, E.ENTRY_NO, E.GGSNAPNINDEX, E.GGSNCCASINDEX);
    COMMIT; 

 END REFRESH_EGGSN_OBJECTS; 
 */
 PROCEDURE REFRESH_BSC_PCU_DPROC_LIST
 AS
 BEGIN
 
           MERGE INTO NORTHI_DATA.BSC_PCU_DPROC_LIST X USING 
    (
        SELECT DISTINCT
        OMC_ID,CLUSTER_ID,REGION_ID,OMC_NAME,CLUSTER_NAME,REGION_NAME, 
        A.BSC_ID,
        BSC_NAME,
        PCU_ID,
        PCU_NAME,
        DPROC_ID,
        DPROC_NAME,MAIN_REGION_ID, MAIN_REGION_NAME, SUB_REGION_ID, SUB_REGION_NAME
        FROM 
        (
            select
            (select PARENT_ID from northi_data.objects b where a.parent_id=b.network_id and rownum=1) BSC_ID,
            PARENT_ID PCU_ID, 
            (select name from northi_data.objects b where a.parent_id=b.network_id and rownum=1) PCU_NAME, 
            NETWORK_ID DPROC_id,
            name DPROC_NAME
            from northi_data.objects a
            where object_class_id=71
            AND STATE=0
        ) A, 
        (SELECT DISTINCT OMC_ID,CLUSTER_ID,REGION_ID,OMC_NAME,CLUSTER_NAME,REGION_NAME,BSC_ID,BSC_NAME,
                  NULL MAIN_REGION_ID, NULL MAIN_REGION_NAME, NULL SUB_REGION_ID, NULL SUB_REGION_NAME
           FROM NORTHI_DATA.OMC_BSC_BTS_CELL_LIST WHERE STATE_BSC=0  and cluster_id <> -99) C
        WHERE A.BSC_ID=C.BSC_ID AND BSC_NAME NOT LIKE '%_TEST%'
    )E
    ON (X.DPROC_ID = E.DPROC_ID )
    WHEN NOT MATCHED THEN
        INSERT(X.OMC_ID,X.CLUSTER_ID,X.REGION_ID,X.OMC_NAME,X.CLUSTER_NAME,X.REGION_NAME, X.BSC_ID,X.BSC_NAME, X.PCU_ID,X.PCU_NAME,X.DPROC_ID,X.DPROC_NAME,
                X.MAIN_REGION_ID, X.MAIN_REGION_NAME, X.SUB_REGION_ID, X.SUB_REGION_NAME)
        VALUES(E.OMC_ID,E.CLUSTER_ID,E.REGION_ID,E.OMC_NAME,E.CLUSTER_NAME,E.REGION_NAME, E.BSC_ID,E.BSC_NAME, E.PCU_ID,E.PCU_NAME,E.DPROC_ID,E.DPROC_NAME,
                E.MAIN_REGION_ID, E.MAIN_REGION_NAME, E.SUB_REGION_ID, E.SUB_REGION_NAME)
    WHEN MATCHED THEN
            UPDATE SET X.OMC_ID = E.OMC_ID,
                                 X.CLUSTER_ID = E.CLUSTER_ID,
                                 X.REGION_ID = E.REGION_ID,
                                 X.OMC_NAME = E.OMC_NAME,
                                 X.CLUSTER_NAME = E.CLUSTER_NAME,
                                 X.REGION_NAME = E.REGION_NAME,
                                 X.BSC_ID = E.BSC_ID,
                                 X.BSC_NAME =  E.BSC_NAME, 
                                 X.PCU_NAME =  E.PCU_NAME,
--                                 X.DPROC_ID = E.DPROC_ID,
                                 X.DPROC_NAME = E.DPROC_NAME,
                                 X.MAIN_REGION_ID =  E.MAIN_REGION_ID, 
                                 X.MAIN_REGION_NAME = E.MAIN_REGION_NAME, 
                                 X.SUB_REGION_ID = E.SUB_REGION_ID, 
                                 X.SUB_REGION_NAME = E.SUB_REGION_NAME,
                                 X.PCU_ID = E.PCU_ID;
    COMMIT;
    
                                                                              
    
 END;
 
PROCEDURE UPDATE_S7LINK_BTS_BSC_LIST
AS                                  
BEGIN
 DELETE FROM NORTHI_DATA.S7LINK_BTS_BSC_LIST;
    
    
    
    INSERT /*+ append */ INTO NORTHI_DATA.S7LINK_BTS_BSC_LIST                       
    SELECT A.NETWORK_ID LINK_ID,A.NAME LINK_NAME,B.NETWORK_ID BTS_ID,B.NAME BTS_NAME, BSC.NETWORK_ID BSC_ID, BSC.NAME BSC_NAME,CL.CLUSTER_ID, CL.CLUSTER_NAME,
           OMC.NETWORK_ID OMC_ID, OMC.NAME OMC_NAME, CL.REGION_ID, CL.REGION REGION_NAME,
           O.MAIN_REGION_ID, O.MAIN_REGION_NAME, O.SUB_REGION_ID, O.SUB_REGION_NAME
    FROM NORTHI.S7LINK_LIST A 
    LEFT OUTER JOIN NORTHI.BTS_LIST B ON (A.PARENT_ID=B.NETWORK_ID)
    LEFT OUTER JOIN NORTHI.BSC_LIST BSC ON (B.PARENT_ID = BSC.NETWORK_ID)
    LEFT JOIN  NORTHI.OMC_LIST OMC ON(OMC.NETWORK_ID = TRUNC (BSC.NETWORK_ID, -9) or omc.network_id = TRUNC (bsc.network_id, -18))
    LEFT OUTER JOIN NORTHI.CLUSTER_LIST CL ON (BSC.NETWORK_ID=CL.NETWORK_ID)
    LEFT OUTER JOIN NORTHI_DATA.OMC_BSC_BTS_CELL_LIST O ON (A.PARENT_ID=O.BTS_ID);
    
    

    /*
    
      INSERT INTO NORTHI_DATA.S7LINK_BTS_BSC_LIST                       
    SELECT A.NETWORK_ID LINK_ID,A.NAME LINK_NAME,B.NETWORK_ID BTS_ID,B.NAME BTS_NAME, BSC.NETWORK_ID BSC_ID, BSC.NAME BSC_NAME,CL.CLUSTER_ID, CL.CLUSTER_NAME, OMC.NETWORK_ID OMC_ID, OMC.NAME OMC_NAME, CL.REGION_ID, CL.REGION REGION_NAME
    FROM NORTHI.S7LINK_LIST A 
    LEFT OUTER JOIN NORTHI.BTS_LIST B ON (A.PARENT_ID=B.NETWORK_ID)
    LEFT OUTER JOIN NORTHI.BSC_LIST BSC ON (B.PARENT_ID = BSC.NETWORK_ID)
    LEFT JOIN  NORTHI.OMC_LIST OMC ON(OMC.NETWORK_ID = TRUNC (BSC.NETWORK_ID, -9) or omc.network_id = TRUNC (bsc.network_id, -18))
    LEFT OUTER JOIN NORTHI.CLUSTER_LIST CL ON (BSC.NETWORK_ID=CL.NETWORK_ID);
    
    */
    COMMIT;
    
      update NORTHI_DATA.S7LINK_BTS_BSC_LIST
       set cluster_id = -99
     where cluster_id is null;
     
    update NORTHI_DATA.S7LINK_BTS_BSC_LIST
       set cluster_name = 'null'
     where cluster_name is null;
    
    update NORTHI_DATA.S7LINK_BTS_BSC_LIST
       set region_id = -99
     where region_id is null;
     
    update NORTHI_DATA.S7LINK_BTS_BSC_LIST
       set region_name = 'null'
     where region_name is null;
     
/*   YENI MAIN REGION ICIN; ESKI CELL'ERI -99 NULL REGIONINA ATIYOR.  */


    update NORTHI_DATA.S7LINK_BTS_BSC_LIST
       set MAIN_REGION_NAME = 'null',
           MAIN_REGION_ID = -99,
           SUB_REGION_NAME ='null',
           SUB_REGION_ID =-99
     where SUB_REGION_NAME is null;
 
 COMMIT;
    
END;

PROCEDURE UPDATE_LAPD_BTS_BSC_LIST AS
BEGIN
    
    
    DELETE FROM  NORTHI_DATA.LAPD_BTS_BSC_LIST;

    INSERT /*+ append */ INTO NORTHI_DATA.LAPD_BTS_BSC_LIST
      SELECT   A.NETWORK_ID LAPD_ID,A.NAME LAPD_NAME,BTS.NETWORK_ID BTS_ID,BTS.NAME BTS_NAME,BSC_ID,BSC_NAME,CLUSTER_ID,CLUSTER_NAME,REGION_ID,REGION_NAME,OMC_ID,OMC_NAME,
             MAIN_REGION_ID, MAIN_REGION_NAME, SUB_REGION_ID, SUB_REGION_NAME
    FROM      NORTHI.LAPD_LIST A LEFT OUTER JOIN NORTHI.BTS_LIST BTS ON (A.PARENT_ID = BTS.NETWORK_ID) LEFT OUTER JOIN
    (SELECT  DISTINCT BTS_ID,BTS_NAME,BSC_ID,BSC_NAME,CLUSTER_ID,CLUSTER_NAME,REGION_ID,REGION_NAME,OMC_ID,OMC_NAME,
             MAIN_REGION_ID, MAIN_REGION_NAME, SUB_REGION_ID, SUB_REGION_NAME
       FROM   NORTHI_DATA.OMC_BSC_BTS_CELL_LIST) B
    ON (BTS.NETWORK_ID = B.BTS_ID);
    
    COMMIT;
/*    SELECT   NETWORK_ID LAPD_ID,NAME LAPD_NAME,BTS_ID,BTS_NAME,BSC_ID,BSC_NAME,CLUSTER_ID,CLUSTER_NAME,REGION_ID,REGION_NAME,OMC_ID,OMC_NAME,
             MAIN_REGION_ID, MAIN_REGION, SUB_REGION_ID, SUB_REGION
    FROM      NORTHI.LAPD_LIST A LEFT OUTER JOIN 
    (SELECT  DISTINCT BTS_ID,BTS_NAME,BSC_ID,BSC_NAME,CLUSTER_ID,CLUSTER_NAME,REGION_ID,REGION_NAME,OMC_ID,OMC_NAME,
             MAIN_REGION_ID, MAIN_REGION, SUB_REGION_ID, SUB_REGION
       FROM   NORTHI_DATA.OMC_BSC_BTS_CELL_LIST) B
    ON (A.PARENT_ID = B.BTS_ID);
*/ 
   
    
    DELETE FROM  NORTHI_DATA.LAPD_BTS_BSC_LIST_ALL;
    
    INSERT /*+ append */ INTO NORTHI_DATA.LAPD_BTS_BSC_LIST_ALL
    SELECT   A.NETWORK_ID LAPD_ID,A.NAME LAPD_NAME,BTS.NETWORK_ID BTS_ID,BTS.NAME BTS_NAME,BSC_ID,BSC_NAME,CLUSTER_ID,CLUSTER_NAME,REGION_ID,REGION_NAME,OMC_ID,OMC_NAME, A.STATE,
                 MAIN_REGION_ID, MAIN_REGION_NAME, SUB_REGION_ID, SUB_REGION_NAME
     FROM      NORTHI.LAPD_LIST A LEFT OUTER JOIN NORTHI.BTS_LIST BTS ON (A.PARENT_ID = BTS.NETWORK_ID) LEFT OUTER JOIN
        (SELECT  DISTINCT BTS_ID,BTS_NAME,BSC_ID,BSC_NAME,CLUSTER_ID,CLUSTER_NAME,REGION_ID,REGION_NAME,OMC_ID,OMC_NAME,
                 MAIN_REGION_ID, MAIN_REGION_NAME, SUB_REGION_ID, SUB_REGION_NAME
           FROM   NORTHI_DATA.OMC_BSC_BTS_CELL_LIST) B
        ON (BTS.NETWORK_ID = B.BTS_ID);
     COMMIT;        
/*    SELECT   NETWORK_ID LAPD_ID,NAME LAPD_NAME,BTS_ID,BTS_NAME,BSC_ID,BSC_NAME,CLUSTER_ID,CLUSTER_NAME,REGION_ID,REGION_NAME,OMC_ID,OMC_NAME, A.STATE,
             MAIN_REGION_ID, MAIN_REGION, SUB_REGION_ID, SUB_REGION
    FROM      NORTHI.LAPD_LIST A LEFT OUTER JOIN
    (SELECT  DISTINCT BTS_ID,BTS_NAME,BSC_ID,BSC_NAME,CLUSTER_ID,CLUSTER_NAME,REGION_ID,REGION_NAME,OMC_ID,OMC_NAME,
             MAIN_REGION_ID, MAIN_REGION, SUB_REGION_ID, SUB_REGION
       FROM   NORTHI_DATA.OMC_BSC_BTS_CELL_LIST) B
    ON (A.PARENT_ID = B.BTS_ID);
    COMMIT;
*/
    
END;

PROCEDURE UPDATE_GBL_LIST_TABLE
AS
BEGIN

     DELETE FROM NORTHI_DATA.BSC_PCU_GBL_LIST;
    
    INSERT /*+ append */ INTO NORTHI_DATA.BSC_PCU_GBL_LIST
                (GBL_ID, GBL_NAME, PCU_ID, PCU_NAME, BSC_ID, BSC_NAME, CLUSTER_ID, CLUSTER_NAME, OMC_NAME, OMC_ID, REGION_ID, REGION_NAME, MAIN_REGION_NAME, MAIN_REGION_ID, SUB_REGION_NAME, SUB_REGION_ID,BSC_TIME_SLOT)
    SELECT  GBL_ID,GBL_NAME,PCU_ID,PCU_NAME,BSC_ID,BSC_NAME,CLUSTER_ID, CLUSTER_NAME,OMC_NAME,OMC_ID,REGION_ID,REGION_NAME,MAIN_REGION_NAME, MAIN_REGION_ID,SUB_REGION_NAME,SUB_REGION_ID, GET_BSC_TIME_SLOT(BSC_NAME)
FROM 
(
        SELECT  A.NETWORK_ID GBL_ID,A.NAME GBL_NAME,P.NETWORK_ID PCU_ID,P.NAME PCU_NAME,BSC_ID,BSC_NAME,CLUSTER_ID, CLUSTER_NAME,OMC_NAME,OMC_ID,REGION_ID,REGION_NAME,MAIN_REGION_NAME, MAIN_REGION_ID,SUB_REGION_NAME,SUB_REGION_ID,
         ROW_NUMBER() OVER( PARTITION BY A.NETWORK_ID ORDER BY MAIN_REGION_ID DESC) RN
        FROM 
            NORTHI.GBL_LIST A, 
            NORTHI.PCU_LIST P,
            (SELECT DISTINCT BSC_ID,BSC_NAME,CLUSTER_ID,CLUSTER_NAME, omc_NAME,Omc_ID,REGION_ID, REGION_NAME,MAIN_REGION_NAME, MAIN_REGION_ID, SUB_REGION_NAME, SUB_REGION_ID FROM NORTHI_DATA.OMC_BSC_BTS_CELL_LIST O WHERE STATE_CELL =0 AND STATE_BTS=0 AND  PCELL_ID!=-1) O
        WHERE A.PARENT_ID=P.NETWORK_ID
        AND P.PARENT_ID=O.BSC_ID
) A
WHERE 
A.RN=1;
      
    COMMIT;
END;

PROCEDURE UPDATE_GSL_LIST_TABLE
AS
BEGIN
   DELETE FROM NORTHI_DATA.BSC_PCU_GSL_LIST;
    
    INSERT /*+ append */ INTO NORTHI_DATA.BSC_PCU_GSL_LIST
     SELECT GSL_ID, GSL_NAME, PCU_ID, PCU_NAME, BSC_ID, BSC_NAME, CLUSTER_ID, CLUSTER_NAME, OMC_NAME, OMC_ID, REGION_ID, REGION_NAME, MAIN_REGION_NAME, MAIN_REGION_ID, SUB_REGION_NAME, SUB_REGION_ID
      FROM 
      (
            SELECT A.NETWORK_ID GSL_ID,A.NAME GSL_NAME,P.NETWORK_ID PCU_ID,P.NAME PCU_NAME,P.PARENT_ID BSC_ID, BSC_NAME,CLUSTER_ID,CLUSTER_NAME,OMC_NAME,OMC_ID,REGION_ID,REGION_NAME,MAIN_REGION_NAME, MAIN_REGION_ID, SUB_REGION_NAME, SUB_REGION_ID,
            ROW_NUMBER() OVER( PARTITION BY A.NETWORK_ID ORDER BY MAIN_REGION_ID DESC) RN
            FROM 
                NORTHI.GSL_LIST A,
                NORTHI.PCU_LIST P ,
                (SELECT DISTINCT BSC_ID,BSC_NAME,CLUSTER_ID,CLUSTER_NAME, omc_NAME,Omc_ID,REGION_ID, REGION_NAME,MAIN_REGION_NAME, MAIN_REGION_ID, SUB_REGION_NAME, SUB_REGION_ID FROM NORTHI_DATA.OMC_BSC_BTS_CELL_LIST O WHERE STATE_CELL =0 AND STATE_BTS=0 AND  PCELL_ID!=-1) O
            WHERE 
             A.PARENT_ID=P.NETWORK_ID AND O.BSC_ID=P.PARENT_ID
      )
      WHERE RN=1;
      
    COMMIT;
END;

PROCEDURE REFRESH_2G_OBJECTS
AS

CUR_DATE DATE;
MAX_DATE DATE;
state varchar2(200);
errm varchar2(4000);
errcode number; 

BEGIN

--STATE:= 'REFRESH_OBJECT_LISTS.REFRESH_SGSN_OBJECTS';    
--    begin
----        REFRESH_OBJECT_LISTS.REFRESH_SGSN_OBJECTS;
--    null;
--    EXCEPTION
--         WHEN NO_DATA_FOUND THEN
--           NULL;
--         WHEN OTHERS THEN
----         UPDATE NORTHI_LOADER_PROCESS SET LOADER_STATE=3 WHERE TABLE_NAME=XTABLE_NAME AND DATA_DATE=XDATA_DATE AND VENDOR_ID=1;
--        errm:=SQLERRM;
--        errcode:=sqlCODE;
--       INSERT INTO NORTHI.NORTHI_ERROR_LOG (USER_NAME, ERROR_CODE, ERROR_MSG,TABLE_NAME, DATE_TIME, PROCEDURE_NAME,SQLTEXT) 
--                             VALUES (user     ,errCODE, ERRM  ,null     , sysdate  ,'NORTHI_LOADER.REFRESH_OBJECT_LISTS.REFRESH_2G_OBJECTS',state );
--        COMMIT;
----           raise;
--    end; 

--STATE:= 'REFRESH_OBJECT_LISTS.UPDATE_GBL_LIST_TABLE';    
--    BEGIN
--        REFRESH_OBJECT_LISTS.UPDATE_GBL_LIST_TABLE;
--    EXCEPTION
--         WHEN NO_DATA_FOUND THEN
--           NULL;
--         WHEN OTHERS THEN
----         UPDATE NORTHI_LOADER_PROCESS SET LOADER_STATE=3 WHERE TABLE_NAME=XTABLE_NAME AND DATA_DATE=XDATA_DATE AND VENDOR_ID=1;
--        errm:=SQLERRM;
--        errcode:=sqlCODE;
--       INSERT INTO NORTHI.NORTHI_ERROR_LOG (USER_NAME, ERROR_CODE, ERROR_MSG,TABLE_NAME, DATE_TIME, PROCEDURE_NAME,SQLTEXT) 
--                             VALUES (user     ,errCODE, ERRM  ,null     , sysdate  ,'NORTHI_LOADER.REFRESH_OBJECT_LISTS.REFRESH_2G_OBJECTS',state );
--        COMMIT;
----           raise;
--    end;
  
--STATE:= 'REFRESH_OBJECT_LISTS.UPDATE_GSL_LIST_TABLE';     
--    BEGIN
--        REFRESH_OBJECT_LISTS.UPDATE_GSL_LIST_TABLE;
--    EXCEPTION
--         WHEN NO_DATA_FOUND THEN
--           NULL;
--         WHEN OTHERS THEN
----         UPDATE NORTHI_LOADER_PROCESS SET LOADER_STATE=3 WHERE TABLE_NAME=XTABLE_NAME AND DATA_DATE=XDATA_DATE AND VENDOR_ID=1;
--        errm:=SQLERRM;
--        errcode:=sqlCODE;
--       INSERT INTO NORTHI.NORTHI_ERROR_LOG (USER_NAME, ERROR_CODE, ERROR_MSG,TABLE_NAME, DATE_TIME, PROCEDURE_NAME,SQLTEXT) 
--                             VALUES (user     ,errCODE, ERRM  ,null     , sysdate  ,'NORTHI_LOADER.REFRESH_OBJECT_LISTS.REFRESH_2G_OBJECTS',state );
--        COMMIT;
----           raise;
--    end;
--STATE:= 'REFRESH_OBJECT_LISTS.UPDATE_LAPD_BTS_BSC_LIST';         
--    BEGIN 
--    REFRESH_OBJECT_LISTS.UPDATE_LAPD_BTS_BSC_LIST;
--    EXCEPTION
--         WHEN NO_DATA_FOUND THEN
--           NULL;
--         WHEN OTHERS THEN
----         UPDATE NORTHI_LOADER_PROCESS SET LOADER_STATE=3 WHERE TABLE_NAME=XTABLE_NAME AND DATA_DATE=XDATA_DATE AND VENDOR_ID=1;
--        errm:=SQLERRM;
--        errcode:=sqlCODE;
--       INSERT INTO NORTHI.NORTHI_ERROR_LOG (USER_NAME, ERROR_CODE, ERROR_MSG,TABLE_NAME, DATE_TIME, PROCEDURE_NAME,SQLTEXT) 
--                             VALUES (user     ,errCODE, ERRM  ,null     , sysdate  ,'NORTHI_LOADER.REFRESH_OBJECT_LISTS.REFRESH_2G_OBJECTS',state );
--        COMMIT;
----           raise;
--    end;
--STATE:= 'REFRESH_OBJECT_LISTS.UPDATE_S7LINK_BTS_BSC_LIST';    
--    BEGIN 
--    REFRESH_OBJECT_LISTS.UPDATE_S7LINK_BTS_BSC_LIST;
--    EXCEPTION
--         WHEN NO_DATA_FOUND THEN
--           NULL;
--         WHEN OTHERS THEN
----         UPDATE NORTHI_LOADER_PROCESS SET LOADER_STATE=3 WHERE TABLE_NAME=XTABLE_NAME AND DATA_DATE=XDATA_DATE AND VENDOR_ID=1;
--        errm:=SQLERRM;
--        errcode:=sqlCODE;
--       INSERT INTO NORTHI.NORTHI_ERROR_LOG (USER_NAME, ERROR_CODE, ERROR_MSG,TABLE_NAME, DATE_TIME, PROCEDURE_NAME,SQLTEXT) 
--                             VALUES (user     ,errCODE, ERRM  ,null     , sysdate  ,'NORTHI_LOADER.REFRESH_OBJECT_LISTS.REFRESH_2G_OBJECTS',state );
--        COMMIT;
----           raise;
--    end;  

--STATE:= 'REFRESH_OBJECT_LISTS.REFRESH_BSC_PCU_DPROC_LIST';
--BEGIN         
--    REFRESH_OBJECT_LISTS.REFRESH_BSC_PCU_DPROC_LIST;
--   EXCEPTION
--         WHEN NO_DATA_FOUND THEN
--           NULL;
--         WHEN OTHERS THEN
----         UPDATE NORTHI_LOADER_PROCESS SET LOADER_STATE=3 WHERE TABLE_NAME=XTABLE_NAME AND DATA_DATE=XDATA_DATE AND VENDOR_ID=1;
--        errm:=SQLERRM;
--        errcode:=sqlCODE;
--       INSERT INTO NORTHI.NORTHI_ERROR_LOG (USER_NAME, ERROR_CODE, ERROR_MSG,TABLE_NAME, DATE_TIME, PROCEDURE_NAME,SQLTEXT) 
--                             VALUES (user     ,errCODE, ERRM  ,null     , sysdate  ,'NORTHI_LOADER.REFRESH_OBJECT_LISTS.REFRESH_2G_OBJECTS',state );
--        COMMIT;
----           raise;
--    end;      
    
STATE:= 'NORTHI_DATA.objects';   

execute immediate 'ALTER SESSION DISABLE PARALLEL DML';  
    delete from NORTHI_DATA.objects;
    
    insert /*+ append */ into NORTHI_DATA.OBJECTS
    SELECT * FROM NORTHI.OBJECTS;
    
    COMMIT;
    
--execute immediate 'ALTER SESSION ENABLE PARALLEL DML';     
    
STATE:= 'northi.RESIZE_OBJECT';         
    northi.RESIZE_OBJECT;

STATE:= 'NORTHI_DATA.CARRIER_LIST'; 
    DELETE FROM NORTHI_DATA.CARRIER_LIST; 
    
    INSERT /*+ append */ INTO NORTHI_DATA.CARRIER_LIST (NETWORK_ID, PARENT_ID, CLASS_NAME, NAME, STATE) 
    SELECT C.NETWORK_ID, C.PARENT_ID, C.CLASS_NAME, C.NAME, C.STATE
      FROM NORTHI.CARRIER_LIST C;
      
    COMMIT;
    
      /* resize CARRIER_LIST */
STATE:= 'resize CARRIER_LIST';    
    execute immediate 'alter table northi_data.CARRIER_LIST move tablespace NORTHI';
   
    EXECUTE IMMEDIATE 'ALTER index NORTHI_DATA.IDX_CARRIER_LIST_P  REBUILD  TABLESPACE NORTHI_DATA_INDEX  PARALLEL 16';
    EXECUTE IMMEDIATE 'ALTER index NORTHI_DATA.IDX_CARR_LIST_NP  REBUILD  TABLESPACE NORTHI_DATA_INDEX PARALLEL 16';
    EXECUTE IMMEDIATE 'ALTER index NORTHI_DATA.IDX_CARR_LIST_NP  REBUILD  TABLESPACE NORTHI_DATA_INDEX PARALLEL 16';
    
    
    /*      **********            */

STATE:= 'NORTHI_DATA.CELL_LIST_2G';    
    DELETE FROM   NORTHI_DATA.CELL_LIST_2G;
  
    INSERT /*+ append */ INTO NORTHI_DATA.CELL_LIST_2G (   NETWORK_ID, PARENT_ID, CLASS_NAME,  NAME, STATE, PCELL_ID) 
    SELECT  C.NETWORK_ID, C.PARENT_ID, C.CLASS_NAME,   C.NAME, C.STATE, C.PCELL_ID 
      FROM NORTHI.CELL_LIST C;
  
    COMMIT;
    
    /* resize CELL_LIST_2G */
STATE:= 'resize CELL_LIST_2G';        
    execute immediate 'alter table northi_data.CELL_LIST_2G move tablespace NORTHI';
   
    EXECUTE IMMEDIATE 'ALTER index NORTHI_DATA.IDX_CELL_LIST_N  REBUILD  TABLESPACE NORTHI_DATA_INDEX PARALLEL 16 ';
    EXECUTE IMMEDIATE 'ALTER index NORTHI_DATA.IDX_CELL_LIST_P  REBUILD  TABLESPACE NORTHI_DATA_INDEX PARALLEL 16 ';
    EXECUTE IMMEDIATE 'ALTER index NORTHI_DATA.IDX_CELL_LIST_PCELL  REBUILD  TABLESPACE NORTHI_DATA_INDEX PARALLEL 16 ';
     
    
    /*      **********            */
STATE:= 'NORTHI_DATA.CITY_SITE_CELL_LIST';       
    DELETE FROM NORTHI_DATA.CITY_SITE_CELL_LIST;
    
    INSERT /*+ append */  INTO NORTHI_DATA.CITY_SITE_CELL_LIST (CITY_CODE, SITE_ID, CELL_ID,CELL_NAME, BTS_ID, BTS_NAME, STATE_CELL, STATE_BTS) 
    SELECT C.CITY_CODE, C.SITE_ID, C.CELL_ID, C.CELL_NAME, C.BTS_ID, C.BTS_NAME, STATE_CELL, STATE_BTS
      FROM NORTHI.CITY_SITE_CELL_LIST C;
      
    COMMIT;    
    
         /* resize CITY_SITE_CELL_LIST */
STATE:= 'resize CITY_SITE_CELL_LIST';       
    execute immediate 'alter table northi_data.CITY_SITE_CELL_LIST move tablespace NORTHI';
   
    EXECUTE IMMEDIATE 'ALTER index NORTHI_DATA.CITY_SITE_CELL_B  REBUILD  TABLESPACE NORTHI_DATA_INDEX PARALLEL 16 ';
    EXECUTE IMMEDIATE 'ALTER index NORTHI_DATA.IDXCITY_SITE_CELL_LIST_C  REBUILD  TABLESPACE NORTHI_DATA_INDEX PARALLEL 16 ';
    EXECUTE IMMEDIATE 'ALTER index NORTHI_DATA.IDXCITY_SITE_CELL_LIST_CC  REBUILD  TABLESPACE NORTHI_DATA_INDEX PARALLEL 16 ';
    
  
    
    /*      **********            */
    
    

/*  old cluster list    
 
    DELETE FROM NORTHI_DATA.CLUSTER_CELL_LIST;
        
    INSERT  INTO NORTHI_DATA.CLUSTER_CELL_LIST ( CLUSTER_ID, CLUSTER_NAME, CELL_ID, CELL_NAME, REGION, REGION_ID) 
    SELECT C.CLUSTER_ID, C.CLUSTER_NAME, C.CELL_ID, C.CELL_NAME, C.REGION, C.REGION_ID 
      FROM NORTHI.CLUSTER_CELL_LIST C;
        
    COMMIT;    
        
    DELETE FROM  NORTHI_DATA.CLUSTER_LIST;
   
    INSERT INTO NORTHI_DATA.CLUSTER_LIST (  CLUSTER_ID, CLUSTER_NAME, NETWORK_ID,CLUSTER_PHASE, BSC_NAME, REGION, REGION_ID) 
    SELECT C.CLUSTER_ID, C.CLUSTER_NAME, C.NETWORK_ID, C.CLUSTER_PHASE, C.BSC_NAME, C.REGION, C.REGION_ID
      FROM NORTHI.CLUSTER_LIST C;
      
    COMMIT;
    
    DELETE FROM NORTHI_DATA.CLUSTER_LIST_VIEW;    
        
    INSERT INTO NORTHI_DATA.CLUSTER_LIST_VIEW (  CLUSTER_ID, CLUSTER_NAME)
    SELECT c.CLUSTER_ID, C.CLUSTER_NAME
      FROM NORTHI.CLUSTER_LIST_VIEW C;
      
    COMMIT;
        
*/

STATE:= 'NORTHI_DATA.CLUTTER_CELL_LIST';        
    DELETE FROM NORTHI_DATA.CLUTTER_CELL_LIST;
        
    INSERT /*+ append */ INTO NORTHI_DATA.CLUTTER_CELL_LIST (PCELL_ID, NETWORK_ID, CELL_NAME,DENSEURBAN, MEANURBAN, TAXAREA,RESIDENTIAL, BLOCKBUILDINGS, INDUSTRIAL_COMMERCIAL, 
                            VILLAGES, FOREST, SPARSEFOREST,OPENWETAREA, PARKS, INLANDWATER,SEA, OPENLAND, OTHERCOUNTRIES,PROVINCE, DISTRICT, CITY_CODE, ID) 
    SELECT C.PCELL_ID, C.NETWORK_ID, C.CELL_NAME,C.DENSEURBAN, C.MEANURBAN, C.TAXAREA,C.RESIDENTIAL, C.BLOCKBUILDINGS, C.INDUSTRIAL_COMMERCIAL,C.VILLAGES, C.FOREST, C.SPARSEFOREST, 
       C.OPENWETAREA, C.PARKS, C.INLANDWATER,C.SEA, C.OPENLAND, C.OTHERCOUNTRIES,C.PROVINCE, C.DISTRICT, C.CITY_CODE, C.ID
    FROM NORTHI_DATA.CLUTTER_CELL_LIST C;

    COMMIT;    



/*  OLD REGION

    INSERT INTO NORTHI_DATA.OMC_BSC_BTS_CELL_LIST (OMC_ID, OMC_NAME, BSC_ID,BSC_NAME, BTS_ID, BTS_NAME,CELL_ID, CELL_NAME, STATE_CELL, 
                                STATE_BTS, STATE_BSC, CLUSTER_ID,CLUSTER_NAME, REGION_ID, REGION_NAME, PCELL_ID)
    SELECT O.OMC_ID, O.OMC_NAME, O.BSC_ID,O.BSC_NAME, O.BTS_ID, O.BTS_NAME,O.CELL_ID, O.CELL_NAME, O.STATE_CELL,O.STATE_BTS, O.STATE_BSC 
           ,C.CLUSTER_ID, C.CLUSTERR CLUSTER_NAME, C.REGION_ID, C.REGION REGION_NAME, O.PCELL_ID
           
    FROM NORTHI.OMC_BSC_BTS_CELL_LIST O LEFT OUTER JOIN NORTHI_DATA.REGION_CLUSTER_2G_LIST C ON (O.BSC_ID=C.BSC_ID) ; 
    
*/  
/*     ESKI REGION'A GORE
   INSERT /*+ append */  /*INTO NORTHI_DATA.OMC_BSC_BTS_CELL_LIST (OMC_ID, OMC_NAME, BSC_ID,BSC_NAME, BTS_ID, BTS_NAME,CELL_ID, CELL_NAME, STATE_CELL, 
                                STATE_BTS, STATE_BSC, PCELL_ID)
    SELECT O.OMC_ID, O.OMC_NAME, O.BSC_ID,O.BSC_NAME, O.BTS_ID, O.BTS_NAME,O.CELL_ID, O.CELL_NAME, O.STATE_CELL,O.STATE_BTS, O.STATE_BSC, O.PCELL_ID
           
    FROM NORTHI.OMC_BSC_BTS_CELL_LIST O; 


*/    

/********  YENI MAIN REGION'A GORE   ******/


--   DELETE FROM NORTHI_DATA.OMC_BSC_BTS_CELL_LIST;
--   
--   INSERT /*+ append */ INTO NORTHI_DATA.OMC_BSC_BTS_CELL_LIST (OMC_ID, OMC_NAME, BSC_ID, BSC_NAME, BTS_ID, BTS_NAME, CELL_ID, CELL_NAME, STATE_CELL, 
--                                STATE_BTS, STATE_BSC, PCELL_ID, MAIN_REGION_NAME, MAIN_REGION_ID, SUB_REGION_NAME, SUB_REGION_ID)
--    
--    SELECT O.OMC_ID, O.OMC_NAME, O.BSC_ID,O.BSC_NAME, O.BTS_ID, O.BTS_NAME,O.CELL_ID, O.CELL_NAME, O.STATE_CELL,O.STATE_BTS, O.STATE_BSC, O.PCELL_ID
--      ,R.MAIN_REGION,R.MAIN_REGION_ID,R.SUB_REGION,R.SUB_REGION_ID
--    FROM NORTHI.OMC_BSC_BTS_CELL_LIST O LEFT OUTER join NORTHI.REGION_CLUSTER_2G_LIST R on O.CELL_ID = r.cell_id ; 

-----------------------


STATE:= 'NORTHI_DATA.OMC_BSC_BTS_CELL_LIST';        
 MERGE  /*+ append */
                INTO  NORTHI_DATA.OMC_BSC_BTS_CELL_LIST O
                USING (
                       SELECT O.OMC_ID, O.OMC_NAME, O.BSC_ID,O.BSC_NAME, O.BTS_ID, O.BTS_NAME,O.CELL_ID, O.CELL_NAME, O.STATE_CELL,O.STATE_BTS, O.STATE_BSC, O.PCELL_ID
                          FROM NORTHI.OMC_BSC_BTS_CELL_LIST o
                      ) E
                ON    (O.cell_id = E.cell_id)
                
              WHEN MATCHED THEN
                UPDATE 
                   SET OMC_ID = e.OMC_ID, 
                          OMC_NAME = e.OMC_NAME, 
                          BSC_ID = e.BSC_ID,
                          BSC_NAME = e.BSC_NAME, 
                          BTS_ID = e.BTS_ID, 
                          BTS_NAME = e.BTS_NAME,
                          CELL_NAME = e.CELL_NAME, 
                          STATE_CELL = e.STATE_CELL, 
                          STATE_BTS = e.STATE_BTS, 
                          STATE_BSC = e.STATE_BSC, 
                          PCELL_ID = e.PCELL_ID,
                          VENDOR_ID = NORTHI_DATA.NORTHI_GET_VENDOR_NETWORK_ID(E.OMC_NAME,'2G'),
                          VENDOR_NAME =  NORTHI_DATA.NORTHI_GET_VENDOR_NAME(NORTHI_DATA.NORTHI_GET_VENDOR_NETWORK_ID(E.OMC_NAME,'2G'))
              WHEN NOT MATCHED THEN
                INSERT (OMC_ID, OMC_NAME, BSC_ID,BSC_NAME, BTS_ID, BTS_NAME,CELL_ID, CELL_NAME, STATE_CELL, STATE_BTS, STATE_BSC, PCELL_ID,VENDOR_ID,VENDOR_NAME)
                VALUES ( E.OMC_ID, E.OMC_NAME, E.BSC_ID, E.BSC_NAME, E.BTS_ID, E.BTS_NAME, E.CELL_ID, E.CELL_NAME, E.STATE_CELL, E.STATE_BTS, E.STATE_BSC, E.PCELL_ID,NORTHI_DATA.NORTHI_GET_VENDOR_NETWORK_ID(E.OMC_NAME,'2G'),NORTHI_DATA.NORTHI_GET_VENDOR_NAME(NORTHI_DATA.NORTHI_GET_VENDOR_NETWORK_ID(E.OMC_NAME,'2G')) )      
              WHERE E.cell_id IS NOT NULL
                AND E.OMC_ID IS NOT NULL ; 

    COMMIT;
    
STATE:= 'NORTHI_DATA.OMC_BSC_BTS_CELL_LIST1';     
 UPDATE NORTHI_DATA.OMC_BSC_BTS_CELL_LIST
      SET STATE_CELL = 9, 
          STATE_BTS = 9 
    WHERE (OMC_ID, BSC_ID, BTS_ID, CELL_ID)
       NOT IN (  SELECT OMC_ID, BSC_ID, BTS_ID, CELL_ID FROM NORTHI.OMC_BSC_BTS_CELL_LIST );         

STATE:= 'NORTHI_DATA.OMC_BSC_BTS_CELL_LIST2';     
  MERGE  /*+ append */
                INTO  NORTHI_DATA.OMC_BSC_BTS_CELL_LIST O
                USING (
                       SELECT  DISTINCT cell_id ,R.MAIN_REGION,R.MAIN_REGION_ID,R.SUB_REGION,R.SUB_REGION_ID
                         FROM  NORTHI_DATA.REGION_CLUSTER_2G_LIST r
                      ) E
                ON    (O.cell_id = E.cell_id)
                
              WHEN MATCHED THEN
                UPDATE 
                   SET MAIN_REGION_NAME = e.main_region,
                          MAIN_REGION_ID = e.main_region_id,
                          SUB_REGION_NAME = e.sub_region,
                          SUB_REGION_ID = e.sub_region_id
                          
                 WHERE E.cell_id IS NOT NULL ; 

    COMMIT;

/*  *************************** */

STATE:= 'NORTHI_DATA.OMC_BSC_BTS_CELL_LIST3';         
   MERGE  /*+ append */
                INTO  NORTHI_DATA.OMC_BSC_BTS_CELL_LIST O
                USING (
                                  SELECT BSC_ID, CLUSTER_ID, CLUSTER_NAME,  REGION_ID,  REGION_NAME 
                                    FROM
                                    (

                                         SELECT   BSC_ID,  CLUSTER_ID,CLUSTERR CLUSTER_NAME,  REGION_ID, REGION REGION_NAME,  COUNT(*) ,
                                                        DENSE_RANK() OVER (PARTITION BY BSC_ID ORDER BY COUNT(*)  DESC) R
                                                                 FROM  NORTHI_DATA.REGION_CLUSTER_2G_LIST
                                                                  where cluster_id is not null
                                                                     and region_id is not null
                                                                     and bsc_id is not null
                                                                     and bsc_id not in(3000461519,2000164486,3000312920,2000169826,3003100000440000044)
                                                                     and instr(bsc_name,'~') <= 0
                                                                     AND STATE_CELL =0
                                                   GROUP BY BSC_ID,  CLUSTER_ID,CLUSTERR ,  REGION_ID, REGION  
                                    )
                                    WHERE   R=1
                      ) E
                ON    (O.BSC_ID = E.BSC_ID)
                
              WHEN MATCHED THEN
                UPDATE 
                   SET CLUSTER_ID   = E.CLUSTER_ID,
                       CLUSTER_NAME = E.CLUSTER_NAME, 
                       REGION_ID    = E.REGION_ID, 
                       REGION_NAME  = E.REGION_NAME
                
                 WHERE E.BSC_ID IS NOT NULL ; 
    
    commit;                  
    
STATE:= 'NORTHI_DATA.OMC_BSC_BTS_CELL_LIST4';       
    update NORTHI_DATA.OMC_BSC_BTS_CELL_LIST
       set cluster_id = -99
     where cluster_id is null;
     
    update NORTHI_DATA.OMC_BSC_BTS_CELL_LIST
       set cluster_name = 'null'
     where cluster_name is null;
    
    update NORTHI_DATA.OMC_BSC_BTS_CELL_LIST
       set region_id = -99
     where region_id is null;
     
    update NORTHI_DATA.OMC_BSC_BTS_CELL_LIST
       set region_name = 'null'
     where region_name is null;
     
/*   YENI MAIN REGION ICIN; ESKI CELL'ERI -99 NULL REGIONINA ATIYOR.  */


    update NORTHI_DATA.OMC_BSC_BTS_CELL_LIST
       set MAIN_REGION_NAME = 'null',
           MAIN_REGION_ID = -99,
           SUB_REGION_NAME ='null',
           SUB_REGION_ID =-99
     where SUB_REGION_NAME is null;


/* ******************************************************************* */
       

 commit;   
 
 
 STATE:= 'NORTHI_DATA.OMC_BSC_BTS_CELL_LIST5';     
  MERGE  /*+ append PARALLEL(16) */
                INTO  NORTHI_DATA.OMC_BSC_BTS_CELL_LIST O
                USING (
                       SELECT  DISTINCT cell_id , CITY_CODE, SITE_CLASS, ILCE, MAHALLE
                         FROM  NORTHI_DATA.REGION_CLUSTER_2G_LIST r
                      ) E
                ON    (O.cell_id = E.cell_id)
                
              WHEN MATCHED THEN
                UPDATE 
                   SET CITY_ID    = e.CITY_CODE,
                       SITE_CLASS_NAME   = E.SITE_CLASS,
                       ILCE_NAME         = E.ILCE,
                       MAHALLE_NAME      = E.MAHALLE
                       
                 WHERE E.cell_id IS NOT NULL ; 

    COMMIT;      
    
 
           /***        IL ILCE LIST UPDATE  ***/
           
                    MERGE INTO  NORTHI.LIST_CITY_ILCE O
                        USING ( SELECT DISTINCT A.CITY_CODE, A.ILCE , UAVT_CODE ILCE_CODE 
                                FROM NORTHI_DATA.REGION_CLUSTER_2G_FULL A 
                                LEFT OUTER JOIN 
                                NORTHI_DATA.LIST_CITY_ILCE_CODE CODE 
                        ON  ( A.CITY_CODE=CODE.CITY_CODE AND A.ILCE=CODE.ILCE_NAME ) WHERE UAVT_CODE IS NOT NULL   ORDER BY 1,2
                              ) E
                        ON    (O.CITY_CODE = E.CITY_CODE and  O.ILCE = E.ILCE )
                    WHEN NOT MATCHED THEN    
                    INSERT (CITY_CODE, ILCE, ILCE_ID, ILCE_CODE)
                    VALUES (E.CITY_CODE, E.ILCE, (E.CITY_CODE * 10000000000000) + (NORTHI.SEQ_ILCE.NEXTVAL * 10000000),E.ILCE_CODE ) ;

                    COMMIT;


                    MERGE INTO  NORTHI.LIST_CITY_ILCE_MAHALLE O
                        USING ( 
                                        SELECT DISTINCT L1.CITY_CODE, IL.ILCE_ID, L1.ILCE, ILCE_CODE, MAHALLE  
                                          FROM NORTHI_DATA.REGION_CLUSTER_2G_FULL L1, NORTHI.LIST_CITY_ILCE IL
                                         WHERE L1.CITY_CODE = IL.CITY_CODE
                                           AND L1.ILCE = IL.ILCE 
                                           AND IL.ILCE_CODE IS NOT NULL
                                           AND MAHALLE IS NOT NULL
                                         ORDER BY 1,2,4
                               ) E
                        ON    (O.CITY_CODE = E.CITY_CODE and  O.ILCE = E.ILCE AND O.MAHALLE = E.MAHALLE AND O.ILCE_CODE = E.ILCE_CODE  )
                    WHEN NOT MATCHED THEN    
                    INSERT (CITY_CODE, ILCE, ILCE_ID, MAHALLE_ID, MAHALLE, ILCE_CODE)
                    VALUES (E.CITY_CODE, E.ILCE, E.ILCE_ID, E.ILCE_ID + NORTHI.SEQ_MAHALLE.NEXTVAL, E.MAHALLE ,  E.ILCE_CODE ) ;

                    COMMIT;
                    
                    
                    MERGE /*+ APPEND PARALLEL (8) */ INTO NORTHI_DATA.OMC_BSC_BTS_CELL_LIST O
                        USING (
                                 SELECT  CITY_CODE, ILCE_ID, ILCE, ILCE_CODE, MAHALLE_ID, MAHALLE FROM NORTHI.LIST_CITY_ILCE_MAHALLE
                              ) E
                        ON (O.CITY_ID = E.CITY_CODE AND O.ILCE_NAME = E.ILCE AND O.MAHALLE_NAME = E.MAHALLE)
                     
                     WHEN MATCHED THEN
                        UPDATE SET   ILCE_ID    = E.ILCE_ID,
                                     MAHALLE_ID = E.MAHALLE_ID,
                                     ILCE_CODE = E.ILCE_CODE;
                                     
                      COMMIT;       
                      
                      
                    UPDATE NORTHI_DATA.OMC_BSC_BTS_CELL_LIST
                       SET  ILCE_ID = -99,
                            ILCE_NAME    = 'null'
                     WHERE  ILCE_ID IS NULL;
                    
                    COMMIT;
                    
                    UPDATE NORTHI_DATA.OMC_BSC_BTS_CELL_LIST
                       SET  MAHALLE_ID = -99,
                            MAHALLE_NAME    = 'null'
                     WHERE  MAHALLE_ID IS NULL;
                    
                    COMMIT;
                    
                    UPDATE NORTHI_DATA.OMC_BSC_BTS_CELL_LIST
                       SET  CITY_ID = -99
                     WHERE  CITY_ID IS NULL;
                    
                    COMMIT;   
                    
                    
                    UPDATE NORTHI_DATA.OMC_BSC_BTS_CELL_LIST
                       SET  SITE_CLASS_NAME = 'null',
                            SITE_CLASS_ID = -99
                     WHERE  SITE_CLASS_NAME IS NULL;
                    
                    COMMIT;                   
                        


                             
           /***********************************/
           
    /***        SITE_CLASS LIST UPDATE  ***/       
    MERGE INTO NORTHI_DATA.LIST_SITE_CLASS O
    USING (
            SELECT DISTINCT SITE_CLASS
              FROM NORTHI_DATA.REGION_CLUSTER_2G_FULL ---ATOLL_MULTIRAT.SITES_PRIVATE@ATOLL  06.10.2016 DA DEGSITI
             WHERE SITE_CLASS IS NOT NULL
          ) E
     ON (O.SITE_CLASS = E.SITE_CLASS)
     WHEN NOT MATCHED THEN
       INSERT(SITE_CLASS_ID, SITE_CLASS)
       VALUES(100000+NORTHI_DATA.SEQ_SITE_CLASS_ID.NEXTVAL, E.SITE_CLASS)
    ;
    commit;
    
    
    
    MERGE /*+ APPEND PARALLEL(16) */ INTO NORTHI_DATA.OMC_BSC_BTS_CELL_LIST O
    USING ( SELECT * FROM NORTHI_DATA.LIST_SITE_CLASS) E
    ON ( O.SITE_CLASS_NAME = E.SITE_CLASS)
    WHEN MATCHED THEN
        UPDATE SET SITE_CLASS_ID = E.SITE_CLASS_ID
     ;
     commit;
     
    /***************************************************/
    
    
    /***        CITY NAME UPDATE  ***/   
    MERGE /*+ APPEND PARALLEL(16) */ INTO NORTHI_DATA.OMC_BSC_BTS_CELL_LIST O
    USING ( SELECT * FROM NORTHI_DATA.CITY_LIST) E
    ON ( O.CITY_ID = E.CITY_CODE)
    WHEN MATCHED THEN
        UPDATE SET CITY_NAME = E.NAME
     ;
     commit;
     /***************************************************/                


STATE:= 'NORTHI_DATA.OMC_BSC_BTS_CELL_LIST6';     
  MERGE  /*+ append PARALLEL(16) */
                INTO  NORTHI_DATA.OMC_BSC_BTS_CELL_LIST O
                USING (
                       SELECT  DISTINCT cell_id , LATITUDE, LONGITUDE
                         FROM  NORTHI_DATA.REGION_CLUSTER_2G_LIST r
                      ) E
                ON    (O.cell_id = E.cell_id)
                
              WHEN MATCHED THEN
                UPDATE 
                   SET 
                       LATITUDE     = E.LATITUDE,
                       LONGITUDE    = E.LONGITUDE
                       
                 WHERE E.cell_id IS NOT NULL ; 

    COMMIT;  
    
----------------- ATOLL TANIMLAMASI OLMAYAN CELL LERIN BILGILERINI NULL YAPMA -------------------------
STATE:= 'NORTHI_DATA.OMC_BSC_BTS_CELL_LIST7';

--    UPDATE NORTHI_DATA.OMC_BSC_BTS_CELL_LIST
--    SET 
--        MAIN_REGION_ID = -99,
--        MAIN_REGION_NAME = 'null',
--        SUB_REGION_ID = -99,
--        SUB_REGION_NAME = 'null',
--        SITE_CLASS_ID = -99,
--        SITE_CLASS_NAME = 'null',
--        ILCE_ID = -99,
--        ILCE_NAME = 'null',
--        MAHALLE_ID = -99,
--        MAHALLE_NAME = 'null',
--        CITY_ID = -99,
--        CITY_NAME = 'null'
--   WHERE CELL_NAME IN
--        (
--        SELECT DISTINCT CELL_NAME
--        FROM NORTHI_DATA.OMC_BSC_BTS_CELL_LIST
--        WHERE SUB_REGION_ID NOT IN (1301)

--        MINUS

--        SELECT DISTINCT A.CELL_NAME
--        FROM NORTHI_DATA.OMC_BSC_BTS_CELL_LIST A, NORTHI.REGION_CLUSTER_2G_LIST B 
--        WHERE A.CELL_NAME = B.CELL_NAME
--        );  

       UPDATE NORTHI_DATA.OMC_BSC_BTS_CELL_LIST
       SET 
       MAIN_REGION_ID = 1101,
       MAIN_REGION_NAME = 'Adana',
       SUB_REGION_ID = 1301,
       SUB_REGION_NAME = 'KIBRIS'
       WHERE BSC_NAME IN ('BMAGH01','BGYTH01','BZYTH01','BLEFH01');  
    
COMMIT;  
-------------------------------------------------------------------------------------------------------------
STATE:= 'RESIZE OMC_BSC_BTS_CELL_LIST ';    
     /*  RESIZE OMC_BSC_BTS_CELL_LIST   */
   /*
    execute immediate 'alter table northi_data.OMC_BSC_BTS_CELL_LIST move tablespace NORTHI';
   
    EXECUTE IMMEDIATE 'ALTER index NORTHI_DATA.IDX_O_B_BT_C_CELLID  REBUILD  TABLESPACE NORTHI_DATA_INDEX PARALLEL 16 ';
    EXECUTE IMMEDIATE 'ALTER index NORTHI_DATA.OMC_BSC_BTS_CELL_LIST_BT  REBUILD  TABLESPACE NORTHI_DATA_INDEX PARALLEL 16 ';
    EXECUTE IMMEDIATE 'ALTER index NORTHI_DATA.OMC_BSC_BTS_CELL_LIST_CNAME  REBUILD  TABLESPACE NORTHI_DATA_INDEX PARALLEL 16 ';
    EXECUTE IMMEDIATE 'ALTER index NORTHI_DATA.IDX$$_53100001  REBUILD  TABLESPACE NORTHI_DATA_INDEX PARALLEL 16 ';
    EXECUTE IMMEDIATE 'ALTER index NORTHI_DATA.IDX$$_56BC0001  REBUILD  TABLESPACE NORTHI_DATA_INDEX PARALLEL 16 ';
    EXECUTE IMMEDIATE 'ALTER index NORTHI_DATA.IDX$$_59960001  REBUILD  TABLESPACE NORTHI_DATA_INDEX PARALLEL 16 ';
    EXECUTE IMMEDIATE 'ALTER index NORTHI_DATA.IDX$$_59960002  REBUILD  TABLESPACE NORTHI_DATA_INDEX PARALLEL 16 ';
    EXECUTE IMMEDIATE 'ALTER index NORTHI_DATA.IDX$$_59960003  REBUILD  TABLESPACE NORTHI_DATA_INDEX PARALLEL 16 ';
    EXECUTE IMMEDIATE 'ALTER index NORTHI_DATA.IDX$$_59960004  REBUILD  TABLESPACE NORTHI_DATA_INDEX PARALLEL 16 ';
    EXECUTE IMMEDIATE 'ALTER index NORTHI_DATA.IDX$$_59960005  REBUILD  TABLESPACE NORTHI_DATA_INDEX PARALLEL 16 ';
    EXECUTE IMMEDIATE 'ALTER index NORTHI_DATA.IDX$$_59A00001  REBUILD  TABLESPACE NORTHI_DATA_INDEX PARALLEL 16 ';
   */
 
 /*    ******************************    */
 
  EXCEPTION
     WHEN NO_DATA_FOUND THEN
     
       NULL;
     WHEN OTHERS THEN
        errm:=SQLERRM;
        errcode:=sqlCODE;
        rollback;
       INSERT INTO NORTHI.NORTHI_ERROR_LOG (USER_NAME, ERROR_CODE, ERROR_MSG,TABLE_NAME, DATE_TIME, PROCEDURE_NAME,SQLTEXT) 
                             VALUES (user     ,errCODE, ERRM  ,null     , sysdate  ,'NORTHI_LOADER.REFRESH_OBJECT_LISTS.REFRESH_2G_OBJECTS',state );
        COMMIT;
       --NORTHI.SEND_SMS('905415582888','northi_loader.refresh_object_list.REFRESH_2G_OBJECTS ERROR',TO_CHAR(ERRCODE) ||': '||ERRM  );
        raise;

END;
PROCEDURE REFRESH_FEMTO_OBJECTS
AS

CUR_DATE DATE;
MAX_DATE DATE;
state varchar2(200);
errm varchar2(4000);
errcode number; 

BEGIN

STATE:= 'NORTHI_DATA.OMC_BSC_BTS_CELL_LIST';        
 MERGE  /*+ append */
                INTO  NORTHI_DATA.LIST_FEMTO_BCRGW_CLUSTER_CELL O
                USING (
                           SELECT bsc.network_id BCRGW_ID,
                                   bsc.NAME BCRGW_NAME, bts.network_id CLUSTER_id, bts.NAME CLUSTER_name,
                                   c.network_id cell_id, c.NAME cell_name
                                   ,C.STATE CELL_STATE,BTS.STATE CLUSTER_STATE,BSC.STATE BRCGW_STATE
                                   
                              FROM NORTHI.OBJECTS_FEMTO bsc, NORTHI.OBJECTS_FEMTO bts, NORTHI.OBJECTS_FEMTO c
                             WHERE c.parent_id = bts.network_id
                               AND bts.parent_id = bsc.network_id
                               and C.OBJECT_CLASS_ID = 37
                               and BTS.OBJECT_CLASS_ID = 30
                               AND BSC.OBJECT_CLASS_ID = 31
                      ) E
                ON    (O.cell_id = E.cell_id)
                
              WHEN MATCHED THEN
                UPDATE 
                   SET  
                           
                          BCRGW_ID = e.BCRGW_ID,
                          BCRGW_NAME = e.BCRGW_NAME, 
                          CLUSTER_id = e.CLUSTER_id, 
                          CLUSTER_name = e.CLUSTER_name,
                          CELL_NAME = e.CELL_NAME, 
                          CELL_STATE = e.CELL_STATE, 
                          CLUSTER_STATE = e.CLUSTER_STATE, 
                          BRCGW_STATE = e.BRCGW_STATE
              WHEN NOT MATCHED THEN
                INSERT (BCRGW_ID, BCRGW_NAME, CLUSTER_ID, CLUSTER_NAME, CELL_ID, CELL_NAME, BRCGW_STATE, CLUSTER_STATE, CELL_STATE)
                VALUES (E.BCRGW_ID, E.BCRGW_NAME, E.CLUSTER_ID, E.CLUSTER_NAME, E.CELL_ID, E.CELL_NAME, E.BRCGW_STATE, E.CLUSTER_STATE, E.CELL_STATE )      
              WHERE E.cell_id IS NOT NULL ; 

    COMMIT;

STATE:= 'NORTHI_DATA.LIST_FEMTO_BCRGW_CLUSTER_CELL2';       
     
/*   MAIN-SUB REGION NULL UPDATE  */


    update NORTHI_DATA.LIST_FEMTO_BCRGW_CLUSTER_CELL
       set MAIN_REGION_NAME = 'null',
           MAIN_REGION_ID = -99,
           SUB_REGION_NAME ='null',
           SUB_REGION_ID =-99
     where SUB_REGION_NAME is null;

commit;  

/* ******************************************************************* */

STATE:= 'NORTHI_DATA.LIST_FEMTO_BCRGW_CLUSTER_CELL-3'; 
/*   ILCE NULL UPDATE */


    update NORTHI_DATA.LIST_FEMTO_BCRGW_CLUSTER_CELL
       set ILCE_NAME = 'null',
           ILCE_ID = -99
     where ILCE_NAME is null;

commit;  
/* ******************************************************************* */

STATE:= 'NORTHI_DATA.LIST_FEMTO_BCRGW_CLUSTER_CELL-4'; 

/*   MAHALLE NULL UPDATE */


    update NORTHI_DATA.LIST_FEMTO_BCRGW_CLUSTER_CELL
       set MAHALLE_NAME = 'null',
           MAHALLE_ID = -99
     where MAHALLE_NAME is null;

commit;  
/* ******************************************************************* */       

STATE:= 'NORTHI_DATA.LIST_FEMTO_BCRGW_CLUSTER_CELL-5'; 

/*   CITY NULL UPDATE */


    update NORTHI_DATA.LIST_FEMTO_BCRGW_CLUSTER_CELL
       set CITY_NAME = 'null',
           CITY_ID = -99
     where CITY_NAME is null;

commit;  
/* ******************************************************************* */      
      
 
  EXCEPTION
     WHEN NO_DATA_FOUND THEN
     
       NULL;
     WHEN OTHERS THEN
        errm:=SQLERRM;
        errcode:=sqlCODE;
        rollback;
       INSERT INTO NORTHI.NORTHI_ERROR_LOG (USER_NAME, ERROR_CODE, ERROR_MSG,TABLE_NAME, DATE_TIME, PROCEDURE_NAME,SQLTEXT) 
                             VALUES (user     ,errCODE, ERRM  ,null     , sysdate  ,'NORTHI_LOADER.REFRESH_OBJECT_LISTS.REFRESH_FEMTO_OBJECTS',state );
        COMMIT;
       --NORTHI.SEND_SMS('905415582888','northi_loader.refresh_object_list.REFRESH_FEMTO_OBJECTS ERROR',TO_CHAR(ERRCODE) ||': '||ERRM  );
        raise;

END;


PROCEDURE REFRESH_NEC_OBJECTS
AS

CUR_DATE DATE;
MAX_DATE DATE;
state varchar2(200);
errm varchar2(4000);
errcode number; 

BEGIN

STATE:= 'NORTHI_DATA.LIST_NEC_SPIDERNET_CELL';        
 MERGE  /*+ append */
                INTO  NORTHI_DATA.LIST_NEC_SPIDERNET_CELL O
                USING (
                           SELECT enodeb.network_id enodeb_ID,
                                   enodeb.NAME enodeb_NAME, cell.network_id Cell_id, cell.NAME cell_name
                                   ,Cell.STATE CELL_STATE,enodeb.STATE enodeb_STATE                                   
                              FROM NORTHI.OBJECTS_NEC_SPIDERNET enodeb, 
                                   NORTHI.OBJECTS_NEC_SPIDERNET cell
                              WHERE cell.parent_id = enodeb.network_id
                               and cell.OBJECT_CLASS_ID = 37
                               and enodeb.OBJECT_CLASS_ID = 30
                      ) E
                ON    (O.cell_id = E.cell_id)
                
              WHEN MATCHED THEN
                UPDATE 
                   SET  
                           
                          ENODEB_ID = e.ENODEB_ID,
                          ENODEB_NAME = e.ENODEB_NAME, 
                          CELL_NAME = e.CELL_NAME, 
                          CELL_STATE = e.CELL_STATE, 
                          ENODEB_STATE = e.ENODEB_STATE
              WHEN NOT MATCHED THEN
                INSERT (ENODEB_ID, ENODEB_NAME, CELL_ID, CELL_NAME, ENODEB_STATE, CELL_STATE)
                VALUES (E.ENODEB_ID, E.ENODEB_NAME, E.CELL_ID, E.CELL_NAME,  E.ENODEB_STATE, E.CELL_STATE )      
              WHERE E.cell_id IS NOT NULL ; 

    COMMIT;

STATE:= 'NORTHI_DATA.LIST_NEC_SPIDERNET_CELL2';       
     
/*   MAIN-SUB REGION NULL UPDATE  */


    update NORTHI_DATA.LIST_NEC_SPIDERNET_CELL
       set MAIN_REGION_NAME = 'null',
           MAIN_REGION_ID = -99,
           SUB_REGION_NAME ='null',
           SUB_REGION_ID =-99
     where SUB_REGION_NAME is null;

commit;  

/* ******************************************************************* */

STATE:= 'NORTHI_DATA.LIST_NEC_SPIDERNET_CELL-3'; 
/*   ILCE NULL UPDATE */


    update NORTHI_DATA.LIST_NEC_SPIDERNET_CELL
       set ILCE_NAME = 'null',
           ILCE_ID = -99
     where ILCE_NAME is null;

commit;  
/* ******************************************************************* */

STATE:= 'NORTHI_DATA.LIST_NEC_SPIDERNET_CELL-4'; 

/*   MAHALLE NULL UPDATE */


    update NORTHI_DATA.LIST_NEC_SPIDERNET_CELL
       set MAHALLE_NAME = 'null',
           MAHALLE_ID = -99
     where MAHALLE_NAME is null;

commit;  
/* ******************************************************************* */       

STATE:= 'NORTHI_DATA.LIST_NEC_SPIDERNET_CELL-5'; 

/*   CITY NULL UPDATE */


    update NORTHI_DATA.LIST_NEC_SPIDERNET_CELL
       set CITY_NAME = 'null',
           CITY_ID = -99
     where CITY_NAME is null;

commit;  
/* ******************************************************************* */      
      
 
  EXCEPTION
     WHEN NO_DATA_FOUND THEN
     
       NULL;
     WHEN OTHERS THEN
        errm:=SQLERRM;
        errcode:=sqlCODE;
        rollback;
       INSERT INTO NORTHI.NORTHI_ERROR_LOG (USER_NAME, ERROR_CODE, ERROR_MSG,TABLE_NAME, DATE_TIME, PROCEDURE_NAME,SQLTEXT) 
                             VALUES (user     ,errCODE, ERRM  ,null     , sysdate  ,'NORTHI_LOADER.REFRESH_OBJECT_LISTS.REFRESH_NEC_OBJECTS',state );
        COMMIT;
       --NORTHI.SEND_SMS('905415582888','northi_loader.refresh_object_list.REFRESH_FEMTO_OBJECTS ERROR',TO_CHAR(ERRCODE) ||': '||ERRM  );
        raise;

END;





PROCEDURE REFRESH_OBJECT_TABLES
AS
BEGIN
return;
/*    
    MERGE  INTO NORTHI_DATA.LIST_PAPU_LAC  A USING
    (
        SELECT DISTINCT INT_ID SGSN_ID,TO_NUMBER(INT_ID||PAPU_INDEX) PAPU_ID ,LAC LAC_ID,TO_NUMBER(INT_ID||PAPU_INDEX||LAC) NETWORK_ID,'LAC-'||TO_CHAR(LAC) LAC_NAME
        FROM NORTHI_PARSER.P_SGSN_RAUM
        WHERE PERIOD_START_TIME BETWEEN SYSDATE-1 AND SYSDATE
        --AND PAPU_INDEX>16
        AND RAC<255
    ) E ON (A.NETWORK_ID=E.NETWORK_ID)
    WHEN NOT MATCHED THEN
    INSERT (A.SGSN_ID,A.PAPU_ID,A.LAC_ID,A.NETWORK_ID,A.LAC_NAME)
    VALUES (E.SGSN_ID,E.PAPU_ID,E.LAC_ID,E.NETWORK_ID,E.LAC_NAME);
    COMMIT;
    
    MERGE  INTO NORTHI_DATA.LIST_PAPU_RAC A USING
    (
        SELECT DISTINCT INT_ID SGSN_ID,TO_NUMBER(INT_ID||PAPU_INDEX||LAC) LAC_ID,RAC RAC_ID,TO_NUMBER(INT_ID||PAPU_INDEX||LAC||RAC) NETWORK_ID,'RAC-'||TO_CHAR(RAC) RAC_NAME
        FROM NORTHI_PARSER.P_SGSN_RAUM
        WHERE PERIOD_START_TIME BETWEEN SYSDATE-1 AND SYSDATE
        --AND PAPU_INDEX>16
        AND RAC<255
    ) E ON (A.NETWORK_ID=E.NETWORK_ID)
    WHEN NOT MATCHED THEN
    INSERT (A.SGSN_ID,A.LAC_ID,A.RAC_ID,A.NETWORK_ID,A.RAC_NAME)
    VALUES (E.SGSN_ID,E.LAC_ID,E.RAC_ID,E.NETWORK_ID,E.RAC_NAME);
    COMMIT;
    

    MERGE  INTO NORTHI_DATA.LIST_PAPU A USING
    (  
        SELECT DISTINCT INT_ID SGSN_ID,PAPU_INDEX PAPU_ID,TO_NUMBER(INT_ID||PAPU_INDEX) NETWORK_ID,'PAPU-'||TO_CHAR(PAPU_INDEX) PAPU_NAME
        FROM NORTHI_PARSER.P_SGSN_DATA
        WHERE PERIOD_START_TIME BETWEEN SYSDATE-1 AND SYSDATE 
        AND PAPU_INDEX<=16    
    )E ON (A.NETWORK_ID=E.NETWORK_ID)
    WHEN NOT MATCHED THEN
    INSERT (A.SGSN_ID,A.PAPU_ID,A.NETWORK_ID,A.PAPU_NAME)
    VALUES (E.SGSN_ID,E.PAPU_ID,E.NETWORK_ID,E.PAPU_NAME);
    COMMIT;
    
    MERGE  INTO NORTHI_DATA.LIST_NSEI A USING
    (  
        SELECT DISTINCT INT_ID SGSN_ID,TO_NUMBER(INT_ID||PAPU_INDEX) PAPU_ID,NSEI NSEI_ID,TO_NUMBER(INT_ID||PAPU_INDEX||'0'||NSEI) NETWORK_ID,'NSEI-'||TO_CHAR(NSEI) NSEI_NAME
        FROM NORTHI_PARSER.P_SGSN_NSVC_DATA
        WHERE PERIOD_START_TIME BETWEEN SYSDATE-1 AND SYSDATE
        AND PAPU_INDEX<=16    
    )E ON (A.NETWORK_ID=E.NETWORK_ID)
    WHEN NOT MATCHED THEN
    INSERT (A.SGSN_ID,A.PAPU_ID,A.NSEI_ID,A.NETWORK_ID,A.NSEI_NAME)
    VALUES (E.SGSN_ID,E.PAPU_ID,E.NSEI_ID,E.NETWORK_ID,E.NSEI_NAME);
    COMMIT;
    MERGE  INTO NORTHI_DATA.LIST_NSVCI A USING
    (  
        SELECT DISTINCT INT_ID SGSN_ID,TO_NUMBER(INT_ID||PAPU_INDEX) PAPU_ID,TO_NUMBER(INT_ID||PAPU_INDEX||'0'||NSEI) NSEI_ID,NSVCI NSVCI_ID,TO_NUMBER(INT_ID||PAPU_INDEX||'0'||NSEI||'0'||NSVCI) NETWORK_ID,'NSVCI-'||TO_CHAR(NSVCI) NSVCI_NAME
        FROM NORTHI_PARSER.P_SGSN_NSVC_DATA
        WHERE PERIOD_START_TIME BETWEEN SYSDATE-1 AND SYSDATE 
    )E ON (A.NETWORK_ID=E.NETWORK_ID)
    WHEN NOT MATCHED THEN
    INSERT (A.SGSN_ID,A.PAPU_ID,A.NSEI_ID,A.NSVCI_ID,A.NETWORK_ID,A.NSVCI_NAME)
    VALUES (E.SGSN_ID,E.PAPU_ID,E.NSEI_ID,E.NSVCI_ID,E.NETWORK_ID,E.NSVCI_NAME);
    COMMIT;
    
    MERGE  INTO NORTHI_DATA.LIST_LAC  A USING
    (
        SELECT DISTINCT INT_ID SGSN_ID,LAC LAC_ID,TO_NUMBER(INT_ID||'0'||LAC) NETWORK_ID,'LAC-'||TO_CHAR(LAC) LAC_NAME
        FROM NORTHI_PARSER.P_SGSN_MOBILITY_MANAGEMENT
        WHERE PERIOD_START_TIME BETWEEN SYSDATE-1 AND SYSDATE
        AND PAPU_INDEX>16
        AND RAC<255
    ) E ON (A.NETWORK_ID=E.NETWORK_ID)
    WHEN NOT MATCHED THEN
    INSERT (A.SGSN_ID,A.LAC_ID,A.NETWORK_ID,A.LAC_NAME)
    VALUES (E.SGSN_ID,E.LAC_ID,E.NETWORK_ID,E.LAC_NAME);
    COMMIT;
    
    MERGE INTO NORTHI_DATA.LIST_RAC A USING
    (
        SELECT DISTINCT INT_ID SGSN_ID,TO_NUMBER(INT_ID||'0'||LAC) LAC_ID,RAC RAC_ID,TO_NUMBER(INT_ID||'0'||LAC||RAC) NETWORK_ID,'RAC-'||TO_CHAR(RAC) RAC_NAME
        FROM NORTHI_PARSER.P_SGSN_MOBILITY_MANAGEMENT
        WHERE PERIOD_START_TIME BETWEEN SYSDATE-1 AND SYSDATE
        AND PAPU_INDEX>16
        AND RAC<255
    ) E ON (A.NETWORK_ID=E.NETWORK_ID)
    WHEN NOT MATCHED THEN
    INSERT (A.SGSN_ID,A.LAC_ID,A.RAC_ID,A.NETWORK_ID,A.RAC_NAME)
    VALUES (E.SGSN_ID,E.LAC_ID,E.RAC_ID,E.NETWORK_ID,E.RAC_NAME);
    COMMIT;
    
    MERGE  INTO NORTHI_DATA.LIST_CI A USING
    (
        SELECT DISTINCT INT_ID SGSN_ID,TO_NUMBER(INT_ID||'0'||LAC) LAC_ID,
        TO_NUMBER(INT_ID||'0'||LAC||RAC) RAC_ID ,CI CI_ID,TO_NUMBER(INT_ID||'0'||LAC||RAC||CI) NETWORK_ID,'CI-'||TO_CHAR(CI) CI_NAME
        FROM NORTHI_PARSER.P_SGSN_MOBILITY_MANAGEMENT
        WHERE PERIOD_START_TIME BETWEEN SYSDATE-1 AND SYSDATE
        AND PAPU_INDEX>16
        AND RAC<255
    ) E ON (A.NETWORK_ID=E.NETWORK_ID)
    WHEN NOT MATCHED THEN
    INSERT (A.SGSN_ID,A.LAC_ID,A.RAC_ID,A.CI_ID,A.NETWORK_ID,A.CI_NAME)
    VALUES (E.SGSN_ID,E.LAC_ID,E.RAC_ID,E.CI_ID,E.NETWORK_ID,E.CI_NAME);
    COMMIT;
    MERGE  INTO NORTHI_DATA.LIST_OBJECT A USING
    (
        SELECT DISTINCT INT_ID SGSN_ID,INT_ID||'000'||DECODE(OBJECT_NAME,'PAPU',1,'SMMU',2,'MCHU',3,'OMU',4,'GBU',5,'IPPU',6) OBJECT_ID,OBJECT_NAME,INT_ID||'000'||DECODE(OBJECT_NAME,'PAPU',1,'SMMU',2,'MCHU',3,'OMU',4,'GBU',5,'IPPU',6)||'0'||OBJECT_INDEX OBJECT_INDEX_ID,'Obj-'||OBJECT_INDEX OBJECT_INDEX_NAME
        FROM NORTHI_PARSER.P_SGSN_LOAD
        WHERE PERIOD_START_TIME BETWEEN SYSDATE-1 AND SYSDATE
    ) E ON (A.OBJECT_INDEX_ID=E.OBJECT_INDEX_ID)
    WHEN NOT MATCHED THEN
    INSERT ( A.SGSN_ID,A.OBJECT_ID,A.OBJECT_NAME,A.OBJECT_INDEX_ID,A.OBJECT_INDEX_NAME)
    VALUES ( E.SGSN_ID,E.OBJECT_ID,E.OBJECT_NAME,E.OBJECT_INDEX_ID,E.OBJECT_INDEX_NAME);
    
    COMMIT;
*/
END REFRESH_OBJECT_TABLES;




END;
/
