
  CREATE OR REPLACE EDITIONABLE PROCEDURE "NORTHI_LOADER"."ISAC" (XISLEM NUMBER, XVENDOR NUMBER,  XTABLE_NAME VARCHAR, XDATE1 DATE, XDATE2 DATE, io_cursor OUT SYS_REFCURSOR) IS

BEGIN
     -- Fill Boxes

        IF XISLEM = 1 THEN -- loader active et

           UPDATE NORTHI_LOADER.NORTHI_VENDOR_LIST
           SET ACTIVE=1
           WHERE SYSTEM_ID=XVENDOR;
          commit;
           OPEN io_cursor FOR
           SELECT 'Successfully updated'
           FROM DUAL;

        ELSIF XISLEM = 2 THEN -- loader pasive et

           UPDATE NORTHI_LOADER.NORTHI_VENDOR_LIST
           SET ACTIVE=0
           WHERE SYSTEM_ID=XVENDOR;
           commit;
           OPEN io_cursor FOR
           SELECT 'Successfully updated'
           FROM DUAL;

        ELSIF XISLEM = 3 THEN -- hourly is ac

         UPDATE
         NORTHI_LOADER.NORTHI_LOADER_PROCESS SET LOADER_STATE=0,LOADER_COUNT=2,DAILY_STATE=0
         WHERE ORG_TABLE = XTABLE_NAME AND DATA_DATE BETWEEN XDATE1 AND XDATE2;
         COMMIT;
         OPEN io_cursor FOR
         SELECT 'Successfully updated'
         FROM DUAL;

        ELSIF XISLEM = 4 THEN -- daily is ac

         UPDATE
         NORTHI_LOADER.NORTHI_DAILY_PROCESS SET AGGREGATE_STATE=0,PROCESS_COUNT=2
         WHERE ORG_TABLE = XTABLE_NAME AND DATA_DATE BETWEEN XDATE1 AND XDATE2;
         COMMIT;
          OPEN io_cursor FOR
           SELECT 'Successfully updated'
           FROM DUAL;

        ELSIF XISLEM = 5 THEN -- weekly is ac

          UPDATE NORTHI_LOADER.NORTHI_WEEKLY_PROCESS SET AGGREGATE_STATE=0,PROCESS_COUNT=2
          WHERE ORG_TABLE=XTABLE_NAME AND DATA_DATE BETWEEN TRUNC(XDATE1) AND TRUNC(XDATE2);
          COMMIT;
           OPEN io_cursor FOR
           SELECT 'Successfully updated'
           FROM DUAL;

        ELSIF XISLEM = 6 THEN -- MONTHLY IS AÇ

            UPDATE NORTHI_LOADER.NORTHI_MONTHLY_PROCESS SET AGGREGATE_STATE=0,PROCESS_COUNT=2
          WHERE ORG_TABLE=XTABLE_NAME AND DATA_DATE BETWEEN TRUNC(XDATE1) AND TRUNC(XDATE2);
          COMMIT;
           OPEN io_cursor FOR
           SELECT 'Successfully updated'
           FROM DUAL;

        ELSIF XISLEM = 7 THEN -- hourly is açilmis data
         OPEN io_cursor FOR
          SELECT ROWNUM RN, TABLE_NAME, PARSER_DATE, DATA_DATE, LOADER_DATE, LOADER_STATE, LOAD_DATE, LOADER_DATA_COUNT, LOADER_COUNT, HOURLY_STATE, SYSTEM_ID, DTYPE, DAILY_STATE, ORG_TABLE
          FROM  NORTHI_LOADER.NORTHI_LOADER_PROCESS
          WHERE ORG_TABLE= XTABLE_NAME AND LOADER_STATE=0 AND DATA_DATE BETWEEN XDATE1 AND XDATE2
          ORDER BY DATA_DATE;


        ELSIF XISLEM = 8 THEN -- daily is açilmis data
         OPEN io_cursor FOR
          SELECT ROWNUM RN, TABLE_NAME, DATA_DATE, LOADER_DATE, AGGREGATE_STATE, AGGREGATE_DATE, DATA_COUNT, PROCESS_COUNT, WEEKLY_STATE, MONTHLY_STATE, ORG_TABLE, SYSTEM_ID
          FROM  NORTHI_LOADER.NORTHI_DAILY_PROCESS
          WHERE ORG_TABLE = XTABLE_NAME AND AGGREGATE_STATE=0 AND DATA_DATE BETWEEN TRUNC(XDATE1) AND TRUNC(XDATE2)
          ORDER BY DATA_DATE;


        ELSIF XISLEM = 9 THEN -- weekly is açilmis data
         OPEN io_cursor FOR
          SELECT ROWNUM RN,TABLE_NAME, DATA_DATE, LOADER_DATE, AGGREGATE_STATE, AGGREGATE_DATE, DATA_COUNT, PROCESS_COUNT, ORG_TABLE, SYSTEM_ID
          FROM NORTHI_LOADER.NORTHI_WEEKLY_PROCESS
          WHERE ORG_TABLE=XTABLE_NAME AND AGGREGATE_STATE=0 AND DATA_DATE BETWEEN TRUNC(XDATE1) AND TRUNC(XDATE2)
          ORDER BY DATA_DATE;



        ELSIF XISLEM = 10 THEN -- monthly is açilmis data
         OPEN io_cursor FOR
          SELECT ROWNUM RN, TABLE_NAME, DATA_DATE, LOADER_DATE, AGGREGATE_STATE, AGGREGATE_DATE, DATA_COUNT, PROCESS_COUNT, SYSTEM_ID, ORG_TABLE
          FROM  NORTHI_LOADER.NORTHI_MONTHLY_PROCESS
          WHERE ORG_TABLE=XTABLE_NAME AND AGGREGATE_STATE=0 AND DATA_DATE BETWEEN TRUNC(XDATE1) AND TRUNC(XDATE2)
          ORDER BY DATA_DATE;



        ELSIF XISLEM = 11 THEN -- hourly all is aç

          UPDATE
          NORTHI_LOADER.NORTHI_LOADER_PROCESS SET LOADER_STATE=0,LOADER_COUNT=2,DAILY_STATE=0
          WHERE SYSTEM_ID=XVENDOR AND DATA_DATE BETWEEN XDATE1 AND XDATE2;
          commit;
           OPEN io_cursor FOR
           SELECT 'Successfully updated'
           FROM DUAL;

          ELSIF XISLEM=12 THEN-- daily all is aç

            UPDATE
            NORTHI_LOADER.NORTHI_DAILY_PROCESS SET AGGREGATE_STATE=0,PROCESS_COUNT=2
            WHERE SYSTEM_ID=XVENDOR AND DATA_DATE BETWEEN TRUNC(XDATE1) AND TRUNC(XDATE2);
            COMMIT;
             OPEN io_cursor FOR
           SELECT 'Successfully updated'
           FROM DUAL;

          ELSIF XISLEM = 13 THEN -- weekly all is aç

          UPDATE NORTHI_LOADER.NORTHI_WEEKLY_PROCESS SET AGGREGATE_STATE=0,PROCESS_COUNT=2
          WHERE SYSTEM_ID=XVENDOR AND DATA_DATE BETWEEN TRUNC(XDATE1) AND TRUNC(XDATE2);
          COMMIT;
           OPEN io_cursor FOR
           SELECT 'Successfully updated'
           FROM DUAL;


          ELSIF XISLEM = 14 THEN -- monthly all is aç
           UPDATE NORTHI_LOADER.NORTHI_MONTHLY_PROCESS SET AGGREGATE_STATE=0,PROCESS_COUNT=2
          WHERE SYSTEM_ID=XVENDOR AND DATA_DATE BETWEEN TRUNC(XDATE1) AND TRUNC(XDATE2);
          COMMIT;
           OPEN io_cursor FOR
           SELECT 'Successfully updated'
           FROM DUAL;

          ELSIF XISLEM = 15 THEN ----IS AÇILMAMIS hourly
           OPEN io_cursor FOR
          SELECT ROWNUM RN,TABLE_NAME, PARSER_DATE, DATA_DATE, LOADER_DATE, LOADER_STATE, LOAD_DATE, LOADER_DATA_COUNT, LOADER_COUNT, HOURLY_STATE, SYSTEM_ID, DTYPE, DAILY_STATE, ORG_TABLE
          FROM  NORTHI_LOADER.NORTHI_LOADER_PROCESS
          WHERE ORG_TABLE = XTABLE_NAME AND LOADER_STATE=2 AND DATA_DATE BETWEEN XDATE1 AND XDATE2
          ORDER BY DATA_DATE;

           ELSIF XISLEM = 16 THEN -- daily is açilmamis data
           OPEN io_cursor FOR
          SELECT ROWNUM RN, TABLE_NAME, DATA_DATE, LOADER_DATE, AGGREGATE_STATE, AGGREGATE_DATE, DATA_COUNT, PROCESS_COUNT, WEEKLY_STATE, MONTHLY_STATE, ORG_TABLE, SYSTEM_ID
          FROM  NORTHI_LOADER.NORTHI_DAILY_PROCESS
          WHERE ORG_TABLE = XTABLE_NAME AND AGGREGATE_STATE=2 AND DATA_DATE BETWEEN TRUNC(XDATE1) AND TRUNC(XDATE2)
          ORDER BY DATA_DATE;


         ELSIF XISLEM = 17 THEN -- weekly is açilmamis data
         OPEN io_cursor FOR
          SELECT ROWNUM RN, TABLE_NAME, DATA_DATE, LOADER_DATE, AGGREGATE_STATE, AGGREGATE_DATE, DATA_COUNT, PROCESS_COUNT, ORG_TABLE, SYSTEM_ID
          FROM NORTHI_LOADER.NORTHI_WEEKLY_PROCESS
          WHERE ORG_TABLE=XTABLE_NAME AND AGGREGATE_STATE=2 AND DATA_DATE BETWEEN TRUNC(XDATE1) AND TRUNC(XDATE2)
          ORDER BY DATA_DATE;


           ELSIF XISLEM = 18 THEN -- monthly is açilmamis data
           OPEN io_cursor FOR
          SELECT ROWNUM RN, TABLE_NAME, DATA_DATE, LOADER_DATE, AGGREGATE_STATE, AGGREGATE_DATE, DATA_COUNT, PROCESS_COUNT, SYSTEM_ID, ORG_TABLE
          FROM  NORTHI_LOADER.NORTHI_MONTHLY_PROCESS
          WHERE ORG_TABLE=XTABLE_NAME AND AGGREGATE_STATE=2 AND DATA_DATE BETWEEN TRUNC(XDATE1) AND TRUNC(XDATE2)
          ORDER BY DATA_DATE;

            ELSIF XISLEM = 19 THEN ----ALL IS AÇILMIS hourly
           OPEN io_cursor FOR
          SELECT ROWNUM RN, TABLE_NAME, PARSER_DATE, DATA_DATE, LOADER_DATE, LOADER_STATE, LOAD_DATE, LOADER_DATA_COUNT, LOADER_COUNT, HOURLY_STATE, SYSTEM_ID, DTYPE, DAILY_STATE, ORG_TABLE
          FROM  NORTHI_LOADER.NORTHI_LOADER_PROCESS
          WHERE SYSTEM_ID=XVENDOR AND LOADER_STATE=0 AND DATA_DATE BETWEEN XDATE1 AND XDATE2
          ORDER BY DATA_DATE;

           ELSIF XISLEM = 20 THEN -- daily ALL is açilmis data
           OPEN io_cursor FOR
          SELECT ROWNUM RN, TABLE_NAME, DATA_DATE, LOADER_DATE, AGGREGATE_STATE, AGGREGATE_DATE, DATA_COUNT, PROCESS_COUNT, WEEKLY_STATE, MONTHLY_STATE, ORG_TABLE, SYSTEM_ID
          FROM  NORTHI_LOADER.NORTHI_DAILY_PROCESS
          WHERE SYSTEM_ID=XVENDOR AND AGGREGATE_STATE=0 AND DATA_DATE BETWEEN TRUNC(XDATE1) AND TRUNC(XDATE2)
          ORDER BY DATA_DATE;


         ELSIF XISLEM = 21 THEN -- weekly ALLis açilmis data
         OPEN io_cursor FOR
          SELECT ROWNUM RN, TABLE_NAME, DATA_DATE, LOADER_DATE, AGGREGATE_STATE, AGGREGATE_DATE, DATA_COUNT, PROCESS_COUNT, ORG_TABLE, SYSTEM_ID
          FROM NORTHI_LOADER.NORTHI_WEEKLY_PROCESS
          WHERE SYSTEM_ID=XVENDOR AND AGGREGATE_STATE=0 AND DATA_DATE BETWEEN TRUNC(XDATE1) AND TRUNC(XDATE2)
          ORDER BY DATA_DATE;


           ELSIF XISLEM = 22 THEN -- monthly ALL is açilmis data
           OPEN io_cursor FOR
          SELECT ROWNUM RN, TABLE_NAME, DATA_DATE, LOADER_DATE, AGGREGATE_STATE, AGGREGATE_DATE, DATA_COUNT, PROCESS_COUNT, SYSTEM_ID, ORG_TABLE
          FROM  NORTHI_LOADER.NORTHI_MONTHLY_PROCESS
          WHERE SYSTEM_ID=XVENDOR AND AGGREGATE_STATE=0 AND DATA_DATE BETWEEN TRUNC(XDATE1) AND TRUNC(XDATE2)
          ORDER BY DATA_DATE;

            ELSIF XISLEM = 23 THEN ----ALL IS AÇILMAMIS hourly
           OPEN io_cursor FOR
          SELECT ROWNUM RN, TABLE_NAME, PARSER_DATE, DATA_DATE, LOADER_DATE, LOADER_STATE, LOAD_DATE, LOADER_DATA_COUNT, LOADER_COUNT, HOURLY_STATE, SYSTEM_ID, DTYPE, DAILY_STATE, ORG_TABLE
          FROM  NORTHI_LOADER.NORTHI_LOADER_PROCESS
          WHERE SYSTEM_ID=XVENDOR AND LOADER_STATE=2 AND DATA_DATE BETWEEN XDATE1 AND XDATE2
          ORDER BY DATA_DATE;

           ELSIF XISLEM = 24 THEN -- daily ALL is açilmamis data
           OPEN io_cursor FOR
          SELECT ROWNUM RN, TABLE_NAME, DATA_DATE, LOADER_DATE, AGGREGATE_STATE, AGGREGATE_DATE, DATA_COUNT, PROCESS_COUNT, WEEKLY_STATE, MONTHLY_STATE, ORG_TABLE, SYSTEM_ID
          FROM  NORTHI_LOADER.NORTHI_DAILY_PROCESS
          WHERE SYSTEM_ID=XVENDOR AND AGGREGATE_STATE=2 AND DATA_DATE BETWEEN TRUNC(XDATE1) AND TRUNC(XDATE2)
          ORDER BY DATA_DATE;


         ELSIF XISLEM = 25 THEN -- weekly ALL is açilmamis data
         OPEN io_cursor FOR
          SELECT ROWNUM RN, TABLE_NAME, DATA_DATE, LOADER_DATE, AGGREGATE_STATE, AGGREGATE_DATE, DATA_COUNT, PROCESS_COUNT, ORG_TABLE, SYSTEM_ID
          FROM NORTHI_LOADER.NORTHI_WEEKLY_PROCESS
          WHERE SYSTEM_ID=XVENDOR AND AGGREGATE_STATE=2 AND DATA_DATE BETWEEN TRUNC(XDATE1) AND TRUNC(XDATE2)
          ORDER BY DATA_DATE;


           ELSIF XISLEM = 26 THEN -- monthly ALL is açilmamis data
           OPEN io_cursor FOR
          SELECT ROWNUM RN, TABLE_NAME, DATA_DATE, LOADER_DATE, AGGREGATE_STATE, AGGREGATE_DATE, DATA_COUNT, PROCESS_COUNT, SYSTEM_ID, ORG_TABLE
          FROM  NORTHI_LOADER.NORTHI_MONTHLY_PROCESS
          WHERE SYSTEM_ID=XVENDOR AND AGGREGATE_STATE=2 AND DATA_DATE BETWEEN TRUNC(XDATE1) AND TRUNC(XDATE2)
          ORDER BY DATA_DATE;

          ELSIF XISLEM = 27 THEN -- LOADER ACTIVE-PASIVE SELECT
           OPEN io_cursor FOR
          SELECT SYSTEM_ID,VENDOR_NAME, ACTIVE, SHORT_NAME, VTYPE, PHASE
          FROM  NORTHI_LOADER.NORTHI_VENDOR_LIST;

          ELSIF XISLEM = 28 THEN -- user control
           OPEN io_cursor FOR
          SELECT ROWNUM RN, USERNAME, FIRSTNAME, SURNAME, TITLE, REPORT_ID, REPORT_TABLE, DATE_PARAM1, DATE_PARAM2, QUERY AS QUERYTEXT, RECORD_DATE, USER_ID, ASPNET_SESSION_ID, RECORD_ID, EXECUTION_END_DATE, EXCEPTION_TEXT,RECORD_COUNT, ORACLE_SID, ORACLE_SERIAL
          FROM  NORTHI_DATA.VIEW_NORTHI_REPORT_LOG;

           ELSIF XISLEM = 29 THEN -- DBH IS AÇ

           UPDATE NORTHI_LOADER.NORTHI_dbh_PROCESS SET BH_STATE=0,PROCESS_COUNT=2
           WHERE ORG_TABLE=XTABLE_NAME AND DATA_DATE BETWEEN TRUNC(XDATE1) AND TRUNC(XDATE2);
           COMMIT;
           OPEN io_cursor FOR
           SELECT 'Successfully updated'
           FROM DUAL;

           ELSIF XISLEM = 30 THEN -- WBH IS AÇ

           UPDATE NORTHI_LOADER.NORTHI_WBH_PROCESS SET BH_STATE=0,PROCESS_COUNT=2
           WHERE ORG_TABLE=XTABLE_NAME AND DATA_DATE BETWEEN TRUNC(XDATE1) AND TRUNC(XDATE2);
           COMMIT;
           OPEN io_cursor FOR
           SELECT 'Successfully updated'
           FROM DUAL;

          ELSIF XISLEM = 31 THEN -- MBH IS AÇ

           UPDATE NORTHI_LOADER.NORTHI_MBH_PROCESS SET BH_STATE=0,PROCESS_COUNT=2
           WHERE ORG_TABLE=XTABLE_NAME AND DATA_DATE BETWEEN TRUNC(XDATE1) AND TRUNC(XDATE2);
           COMMIT;
           OPEN io_cursor FOR
           SELECT 'Successfully updated'
           FROM DUAL;

          ELSIF XISLEM = 32 THEN -- DBH IS AÇILMIS DATA
          OPEN io_cursor FOR
          SELECT ROWNUM RN, TABLE_NAME, ORG_TABLE, DATA_DATE, SYSTEM_ID, START_DATE, END_DATE, BH_STATE, BH_PROCEDURE, PROCESS_COUNT
          FROM  NORTHI_LOADER.NORTHI_dbh_PROCESS
          WHERE ORG_TABLE=XTABLE_NAME AND BH_STATE=0 AND DATA_DATE BETWEEN TRUNC(XDATE1) AND TRUNC(XDATE2)
          ORDER BY DATA_DATE;

            ELSIF XISLEM = 33 THEN -- WBH IS AÇILMIS DATA
          OPEN io_cursor FOR
          SELECT ROWNUM RN, TABLE_NAME, ORG_TABLE, DATA_DATE, SYSTEM_ID, START_DATE, END_DATE, BH_STATE, BH_PROCEDURE, PROCESS_COUNT
          FROM  NORTHI_LOADER.NORTHI_WBH_PROCESS
          WHERE ORG_TABLE=XTABLE_NAME AND BH_STATE=0 AND DATA_DATE BETWEEN TRUNC(XDATE1) AND TRUNC(XDATE2)
          ORDER BY DATA_DATE;

             ELSIF XISLEM = 34 THEN -- MBH IS AÇILMIS DATA
          OPEN io_cursor FOR
          SELECT ROWNUM RN, TABLE_NAME, ORG_TABLE, DATA_DATE, SYSTEM_ID, START_DATE, END_DATE, BH_STATE, BH_PROCEDURE, PROCESS_COUNT
          FROM  NORTHI_LOADER.NORTHI_MBH_PROCESS
          WHERE ORG_TABLE=XTABLE_NAME AND BH_STATE=0 AND DATA_DATE BETWEEN TRUNC(XDATE1) AND TRUNC(XDATE2)
          ORDER BY DATA_DATE;


             ELSIF XISLEM = 35 THEN -- DBH IS AÇILMAMIS DATA
          OPEN io_cursor FOR
          SELECT ROWNUM RN, TABLE_NAME, ORG_TABLE, DATA_DATE, SYSTEM_ID, START_DATE, END_DATE, BH_STATE, BH_PROCEDURE, PROCESS_COUNT
          FROM  NORTHI_LOADER.NORTHI_DBH_PROCESS
          WHERE ORG_TABLE=XTABLE_NAME AND BH_STATE=2 AND DATA_DATE BETWEEN TRUNC(XDATE1) AND TRUNC(XDATE2)
          ORDER BY DATA_DATE;

            ELSIF XISLEM = 36 THEN -- WBH IS AÇILMAMIS DATA
          OPEN io_cursor FOR
          SELECT ROWNUM RN, TABLE_NAME, ORG_TABLE, DATA_DATE, SYSTEM_ID, START_DATE, END_DATE, BH_STATE, BH_PROCEDURE, PROCESS_COUNT
          FROM  NORTHI_LOADER.NORTHI_WBH_PROCESS
          WHERE ORG_TABLE=XTABLE_NAME AND BH_STATE=2 AND DATA_DATE BETWEEN TRUNC(XDATE1) AND TRUNC(XDATE2)
          ORDER BY DATA_DATE;

           ELSIF XISLEM = 37 THEN -- MBH IS AÇILMAMIS DATA
          OPEN io_cursor FOR
          SELECT ROWNUM RN, TABLE_NAME, ORG_TABLE, DATA_DATE, SYSTEM_ID, START_DATE, END_DATE, BH_STATE, BH_PROCEDURE, PROCESS_COUNT
          FROM  NORTHI_LOADER.NORTHI_MBH_PROCESS
          WHERE ORG_TABLE=XTABLE_NAME AND BH_STATE=2 AND DATA_DATE BETWEEN TRUNC(XDATE1) AND TRUNC(XDATE2)
          ORDER BY DATA_DATE;

           ELSIF XISLEM = 38 THEN -- DBH --ALL  IS AÇ
           UPDATE NORTHI_LOADER.NORTHI_DBH_PROCESS SET BH_STATE=0,PROCESS_COUNT=2
           WHERE SYSTEM_ID=XVENDOR AND DATA_DATE BETWEEN TRUNC(XDATE1) AND TRUNC(XDATE2);
           COMMIT;
           OPEN io_cursor FOR
           SELECT 'Successfully updated'
           FROM DUAL;

            ELSIF XISLEM = 39 THEN -- WBH --ALL  IS AÇ
           UPDATE NORTHI_LOADER.NORTHI_WBH_PROCESS SET BH_STATE=0,PROCESS_COUNT=2
           WHERE SYSTEM_ID=XVENDOR AND DATA_DATE BETWEEN TRUNC(XDATE1) AND TRUNC(XDATE2);
           COMMIT;
           OPEN io_cursor FOR
           SELECT 'Successfully updated'
           FROM DUAL;

            ELSIF XISLEM = 40 THEN -- MBH --ALL  IS AÇ
           UPDATE NORTHI_LOADER.NORTHI_MBH_PROCESS SET BH_STATE=0,PROCESS_COUNT=2
           WHERE SYSTEM_ID=XVENDOR AND DATA_DATE BETWEEN TRUNC(XDATE1) AND TRUNC(XDATE2);
           COMMIT;
           OPEN io_cursor FOR
           SELECT 'Successfully updated'
           FROM DUAL;

          ELSIF XISLEM = 41 THEN -- DBH -ALL IS AÇILMIS DATA
          OPEN io_cursor FOR
          SELECT ROWNUM RN, TABLE_NAME, ORG_TABLE, DATA_DATE, SYSTEM_ID, START_DATE, END_DATE, BH_STATE, BH_PROCEDURE, PROCESS_COUNT
          FROM  NORTHI_LOADER.NORTHI_DBH_PROCESS
          WHERE BH_STATE=0 AND SYSTEM_ID=XVENDOR AND DATA_DATE BETWEEN TRUNC(XDATE1) AND TRUNC(XDATE2)
          ORDER BY DATA_DATE;

             ELSIF XISLEM = 42 THEN -- WBH -ALL IS AÇILMIS DATA
          OPEN io_cursor FOR
          SELECT ROWNUM RN, TABLE_NAME, ORG_TABLE, DATA_DATE, SYSTEM_ID, START_DATE, END_DATE, BH_STATE, BH_PROCEDURE, PROCESS_COUNT
          FROM  NORTHI_LOADER.NORTHI_WBH_PROCESS
          WHERE BH_STATE=0 AND SYSTEM_ID=XVENDOR AND DATA_DATE BETWEEN TRUNC(XDATE1) AND TRUNC(XDATE2)
          ORDER BY DATA_DATE;

             ELSIF XISLEM = 43 THEN -- MBH -ALL IS AÇILMIS DATA
          OPEN io_cursor FOR
          SELECT ROWNUM RN, TABLE_NAME, ORG_TABLE, DATA_DATE, SYSTEM_ID, START_DATE, END_DATE, BH_STATE, BH_PROCEDURE, PROCESS_COUNT
          FROM  NORTHI_LOADER.NORTHI_MBH_PROCESS
          WHERE BH_STATE=0 AND SYSTEM_ID=XVENDOR AND DATA_DATE BETWEEN TRUNC(XDATE1) AND TRUNC(XDATE2)
          ORDER BY DATA_DATE;


          ELSIF XISLEM = 44 THEN -- DBH -ALL IS AÇILMAMIS DATA
          OPEN io_cursor FOR
          SELECT ROWNUM RN, TABLE_NAME, ORG_TABLE, DATA_DATE, SYSTEM_ID, START_DATE, END_DATE, BH_STATE, BH_PROCEDURE, PROCESS_COUNT
          FROM  NORTHI_LOADER.NORTHI_DBH_PROCESS
          WHERE BH_STATE=2 AND SYSTEM_ID=XVENDOR AND DATA_DATE BETWEEN TRUNC(XDATE1) AND TRUNC(XDATE2)
          ORDER BY DATA_DATE;

            ELSIF XISLEM = 45 THEN -- WBH -ALL IS AÇILMAMIS DATA
          OPEN io_cursor FOR
          SELECT ROWNUM RN, TABLE_NAME, ORG_TABLE, DATA_DATE, SYSTEM_ID, START_DATE, END_DATE, BH_STATE, BH_PROCEDURE, PROCESS_COUNT
          FROM  NORTHI_LOADER.NORTHI_WBH_PROCESS
          WHERE BH_STATE=2 AND SYSTEM_ID=XVENDOR AND DATA_DATE BETWEEN TRUNC(XDATE1) AND TRUNC(XDATE2)
          ORDER BY DATA_DATE;

            ELSIF XISLEM = 46 THEN -- DBH -ALL IS AÇILMAMIS DATA
          OPEN io_cursor FOR
          SELECT ROWNUM RN, TABLE_NAME, ORG_TABLE, DATA_DATE, SYSTEM_ID, START_DATE, END_DATE, BH_STATE, BH_PROCEDURE, PROCESS_COUNT
          FROM  NORTHI_LOADER.NORTHI_MBH_PROCESS
          WHERE BH_STATE=2 AND SYSTEM_ID=XVENDOR AND DATA_DATE BETWEEN TRUNC(XDATE1) AND TRUNC(XDATE2)
          ORDER BY DATA_DATE;

           ELSIF XISLEM = 47 THEN -- RUNNING PROCESS
         OPEN io_cursor FOR
          SELECT ROWNUM RN, PROCEDURE_NAME, PROCEDURE_STATUS, START_DATE, END_DATE, PROCEDURE_STATE, VENDOR_ID
          FROM  NORTHI_LOADER.NORTHI_LOADER_RUNNING_PROCS
          WHERE  PROCEDURE_STATUS='RUNNING'
          ORDER BY START_DATE DESC;


           ELSIF XISLEM = 49 THEN -- SET STOPPED
           UPDATE NORTHI_LOADER.NORTHI_LOADER_RUNNING_PROCS SET PROCEDURE_STATUS='STOPPED'
           WHERE PROCEDURE_NAME=XTABLE_NAME AND PROCEDURE_STATUS='RUNNING';
           COMMIT;
           OPEN io_cursor FOR
           SELECT 'No data to display'
           FROM DUAL;

            ELSIF XISLEM = 50 THEN -- LOADER_STATE=1 OLANI 0'A ÇEKMEK
           UPDATE NORTHI_LOADER.NORTHI_LOADER_PROCESS SET LOADER_STATE=0,LOADER_COUNT=2,DAILY_STATE=0
           WHERE SYSTEM_ID=XVENDOR AND LOADER_STATE=1;
           COMMIT;
           OPEN io_cursor FOR
           SELECT 'No data to display'
           FROM DUAL;

           ELSIF XISLEM = 51 THEN -- DAILY 1 OLANI 0A ÇEKMEK
           UPDATE NORTHI_LOADER.NORTHI_DAILY_PROCESS SET AGGREGATE_STATE=0,PROCESS_COUNT=2
           WHERE SYSTEM_ID=XVENDOR AND AGGREGATE_STATE=1;
           COMMIT;
           OPEN io_cursor FOR
           SELECT 'No data to display'
           FROM DUAL;

           ELSIF XISLEM = 52 THEN -- WEEKLY 1 OLANI 0A ÇEKMEK
           UPDATE NORTHI_LOADER.NORTHI_WEEKLY_PROCESS SET AGGREGATE_STATE=0,PROCESS_COUNT=2
           WHERE SYSTEM_ID=XVENDOR AND AGGREGATE_STATE=1;
           COMMIT;
           OPEN io_cursor FOR
           SELECT 'No data to display'
           FROM DUAL;

           ELSIF XISLEM = 53 THEN -- MONTHLY 1 OLANI 0A ÇEKMEK
           UPDATE NORTHI_LOADER.NORTHI_MONTHLY_PROCESS SET AGGREGATE_STATE=0,PROCESS_COUNT=2
           WHERE SYSTEM_ID=XVENDOR AND AGGREGATE_STATE=1;
           COMMIT;
           OPEN io_cursor FOR
           SELECT 'No data to display'
           FROM DUAL;

             ELSIF XISLEM = 54 THEN -- IS AÇILMIS DATA SAYISI
         OPEN io_cursor FOR
         SELECT DECODE(SYSTEM_ID, 1, 'BSS', 2, 'SGSN', 3,'NSS', 4 ,'3G') AS LOADER , COUNT(*) FROM NORTHI_LOADER.NORTHI_LOADER_PROCESS
        WHERE LOADER_STATE=0
        GROUP BY SYSTEM_ID
          UNION ALL
          SELECT DECODE(SYSTEM_ID, 1, 'BSS_DA', 2, 'SGSN_DA', 3,'NSS_DA', 4 ,'3G_DA') AS LOADER, COUNT(*) FROM NORTHI_LOADER.NORTHI_DAILY_PROCESS
          WHERE AGGREGATE_STATE=0
          GROUP BY SYSTEM_ID
           UNION ALL
         SELECT DECODE(SYSTEM_ID, 1, 'BSS_WA', 2, 'SGSN_WA', 3,'NSS_WA', 4 ,'3G_WA') AS LOADER, COUNT(*) FROM NORTHI_LOADER.NORTHI_WEEKLY_PROCESS
         WHERE AGGREGATE_STATE=0
         GROUP BY SYSTEM_ID
          UNION ALL
          SELECT DECODE(SYSTEM_ID, 1, 'BSS_MA', 2, 'SGSN_MA', 3,'NSS_MA', 4 ,'3G_MA') AS LOADER, COUNT(*) FROM NORTHI_LOADER.NORTHI_MONTHLY_PROCESS
           WHERE AGGREGATE_STATE=0
          GROUP BY SYSTEM_ID;













          END IF;

      EXCEPTION

       WHEN NO_DATA_FOUND THEN
       NULL;
      WHEN OTHERS THEN
      OPEN io_cursor FOR
      select 'NO DATA TO DISPLAY' from DUAL
      RAISE;

      END isac;



/*<TOAD_FILE_CHUNK>*/
/******************************************************************************
   NAME:       LOADER_START
   PURPOSE:

   REVISIONS:
   Ver        Date        Author           Description
   ---------  ----------  ---------------  ------------------------------------
   1.0        07.10.2010          1. Created this procedure.

   NOTES:

   Automatically available Auto Replace Keywords:
      Object Name:     LOADER_START
      Sysdate:         07.10.2010
      Date and Time:   07.10.2010, 09:17:22, and 07.10.2010 09:17:22
      Username:         (set in TOAD Options, Procedure Editor)
      Table Name:       (set in the "New PL/SQL Object" dialog)

******************************************************************************/
/
