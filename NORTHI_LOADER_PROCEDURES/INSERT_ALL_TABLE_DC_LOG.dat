
  CREATE OR REPLACE EDITIONABLE PROCEDURE "NORTHI_LOADER"."INSERT_ALL_TABLE_DC_LOG" 
AS
XSTATEMENT VARCHAR2(32000);
BEGIN

    FOR XTABLES IN
    (
        SELECT DISTINCT TABLE_NAME 
        FROM NORTHI_LOADER_SETTINGS 
        WHERE 
        VENDOR_ID IN(1,5) AND ACTIVE=1
        AND PARTITION_ID  IN (0)
        
        
    )
    LOOP
        XSTATEMENT:='
        INSERT INTO ALL_TABLE_DC_LOG
        (TABLE_NAME,DATA_DATE,DTYPE,VENDOR_ID,DATA_COUNT)
        SELECT '''||
        XTABLES.TABLE_NAME||''' TABLE_NAME,FRAGMENT_DATE,0 DTYPE,1,COUNT(*)
        FROM NORTHI_DATA.'||XTABLES.TABLE_NAME||
        ' WHERE FRAGMENT_DATE BETWEEN TO_DATE(''01.03.2011'',''DD.MM.YYYY HH24'') AND SYSDATE
        GROUP BY FRAGMENT_DATE';
        EXECUTE IMMEDIATE XSTATEMENT;
        Commit;
    END LOOP;
END;
/*
DELETE FROM ALL_TABLE_DC_LOG WHERE VENDOR_ID=1
COMMIT;*/ 
/
