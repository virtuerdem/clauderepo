
  CREATE OR REPLACE EDITIONABLE PROCEDURE "NORTHI_LOADER"."TEMP_CELL32" (XDATA_DATE IN DATE) AS  XREC_COUNT NUMBER;
BEGIN

 DELETE FROM NORTHI_DATA.CELL32 WHERE FRAGMENT_DATE=XDATA_DATE;
 COMMIT;

INSERT INTO NORTHI_DATA.cell32
(NETWORK_ID,
GSM_FR,
GSM_HR,
GSM_EFR,
AMR_FR_CODE0,
AMR_FR_CODE1,
AMR_FR_CODE2,
AMR_FR_CODE3,
AMR_FR_CODE4,
AMF_FR_CODE5,
AMR_FR_CODE6,
AMR_FR_CODE7,
AMR_FR_CODE8,
AMR_FR_CODE9,
AMR_FR_CODE10,
AMR_FR_CODE12,
AMR_FR_CODE14,
AMR_HR_CODE0,
AMR_HR_CODE1,
AMR_HR_CODE2,
AMR_HR_CODE3,
AMR_HR_CODE4,
AMR_HR_CODE5,
AMR_HR_CODE8,
AMR_HR_CODE9,
AMR_HR_CODE10,
FR_AMRWB_CODE0,
OHR_AMRWB_CODE0,
OFR_AMRWB_CODE0,
OFR_AMRWB_CODE1,
OFR_AMRWB_CODE2,
OFR_AMRWB_CODE3,
OFR_AMRWB_CODE4,
OFR_AMRWB_CODE5,
PAG_SR_DEN,
PACASSFAILR_VF_NUM,
SDCCH_CONG_NUM,
TCH_CONGESTION_VF_NUM,
SDCCH_CONG_DEN,
TCH_CONGESTION_VF_DENOM,
SDCCHACCSUCC_VF_DENOM,
SDRFLOSS_VF_DENOM,
SCCHACCSUCC_VF_NUM,
CSSR_VF_DENOM,
PAG_SR_NUM,
CSTCHB_VF_DENOM,
DCR_VF_NW_DENOM,
DCR_NW_WITH_IRATHO_DEN,
DCR_VF_CELL_DENOM,
DCR_VF_BSS_DENOM,
CSTCHB_VF_NUM,
PACASSFAILR_VF_DENOM,
PHOSUC_VF_NUM,
PHOSUC_VF_DENOM,
PHOFAILURE_VF_NUM,
UL_QUAL_FER_DEN,
UL_QUAL_FER_NUM,
CCH_RFLOSSES,
DCR_VF_NUM,
CELL_AVAIL,
FRAGMENT_DATE
)
SELECT 
A.NETWORK_ID                                          NETWORK_ID,
DECODE(SUM(C548003),0,0,SUM(C548002)/SUM(C548003))    GSM_FR,
DECODE(SUM(C548008),0,0,SUM(C548007)/SUM(C548008))    GSM_HR,
DECODE(SUM(C548013),0,0,SUM(C548012)/SUM(C548013))    GSM_EFR,
DECODE(SUM(C548018),0,0,SUM(C548017)/SUM(C548018))    AMR_FR_CODE0,
DECODE(SUM(C548023),0,0,SUM(C548022)/SUM(C548023))    AMR_FR_CODE1,
DECODE(SUM(C548028),0,0,SUM(C548027)/SUM(C548028))    AMR_FR_CODE2,
DECODE(SUM(C548033),0,0,SUM(C548032)/SUM(C548033))    AMR_FR_CODE3,
DECODE(SUM(C548038),0,0,SUM(C548037)/SUM(C548038))    AMR_FR_CODE4,
DECODE(SUM(C548043),0,0,SUM(C548042)/SUM(C548043))    AMF_FR_CODE5,
DECODE(SUM(C548048),0,0,SUM(C548047)/SUM(C548048))    AMR_FR_CODE6,
DECODE(SUM(C548053),0,0,SUM(C548052)/SUM(C548053))    AMR_FR_CODE7,
DECODE(SUM(C548058),0,0,SUM(C548057)/SUM(C548058))    AMR_FR_CODE8,
DECODE(SUM(C548063),0,0,SUM(C548062)/SUM(C548063))    AMR_FR_CODE9,
DECODE(SUM(C548068),0,0,SUM(C548067)/SUM(C548068))    AMR_FR_CODE10,
DECODE(SUM(C548073),0,0,SUM(C548072)/SUM(C548073))    AMR_FR_CODE12,
DECODE(SUM(C548078),0,0,SUM(C548077)/SUM(C548078))    AMR_FR_CODE14,
DECODE(SUM(C548083),0,0,SUM(C548082)/SUM(C548083))    AMR_HR_CODE0,
DECODE(SUM(C548088),0,0,SUM(C548087)/SUM(C548088))    AMR_HR_CODE1,
DECODE(SUM(C548093),0,0,SUM(C548092)/SUM(C548093))    AMR_HR_CODE2,
DECODE(SUM(C548098),0,0,SUM(C548097)/SUM(C548098))    AMR_HR_CODE3,
DECODE(SUM(C548103),0,0,SUM(C548102)/SUM(C548103))    AMR_HR_CODE4,
DECODE(SUM(C548108),0,0,SUM(C548107)/SUM(C548108))    AMR_HR_CODE5,
DECODE(SUM(C548113),0,0,SUM(C548112)/SUM(C548113))    AMR_HR_CODE8,
DECODE(SUM(C548118),0,0,SUM(C548117)/SUM(C548118))    AMR_HR_CODE9,
DECODE(SUM(C548123),0,0,SUM(C548122)/SUM(C548123))    AMR_HR_CODE10,
DECODE(SUM(C548128),0,0,SUM(C548127)/SUM(C548128))    FR_AMRWB_CODE0,
DECODE(SUM(C548133),0,0,SUM(C548132)/SUM(C548133))    OHR_AMRWB_CODE0,
DECODE(SUM(C548138),0,0,SUM(C548137)/SUM(C548138))    OFR_AMRWB_CODE0,
DECODE(SUM(C548143),0,0,SUM(C548142)/SUM(C548143))    OFR_AMRWB_CODE1,
DECODE(SUM(C548148),0,0,SUM(C548147)/SUM(C548148))    OFR_AMRWB_CODE2,
DECODE(SUM(C548153),0,0,SUM(C548152)/SUM(C548153))    OFR_AMRWB_CODE3,
DECODE(SUM(C548158),0,0,SUM(C548157)/SUM(C548158))    OFR_AMRWB_CODE4,
DECODE(SUM(C548163),0,0,SUM(C548162)/SUM(C548163))    OFR_AMRWB_CODE5,
MAX(C468000+C468001)    PAG_SR_DEN,

SUM((C427005-C427006)+(C427004-C427005)-(C427001-C427006)+C476013)    PACASSFAILR_VF_NUM,
SUM(C400000+C400008)    SDCCH_CONG_NUM,
SUM(C400001+C400009)    TCH_CONGESTION_VF_NUM,
SUM(C400004+C400006)    SDCCH_CONG_DEN,
SUM(C400005 + C400007)    TCH_CONGESTION_VF_DENOM,
SUM(C408001+C408007+C408013+C408019+C408037+C408025+C408031)    SDCCHACCSUCC_VF_DENOM,
SUM(C408002+C408008+C408014+C408020+C408026+C408032+C408038-C418000)    SDRFLOSS_VF_DENOM,
SUM(C408002+C408008+C408014+C408020+C408038+C408026+C408032)    SCCHACCSUCC_VF_NUM,
SUM(C408002+C408008+C408014+C408020+C408038+C465002+C465008+C465014+C465020+C465026+C408042-C418000-C418010)    CSSR_VF_DENOM,

SUM(C408014)    PAG_SR_NUM,
SUM(C409037+C410007+ C414037)    CSTCHB_VF_DENOM,
SUM(C409038+C410008+C414038)    DCR_VF_NW_DENOM,
SUM(C409038+C410008+C414038+NVL(C415001,0)+NVL(C421015,0)+NVL(C441001,0)+NVL(C421029,0))   DCR_NW_WITH_IRATHO_DEN,
SUM(C409038+C410008+C414038+NVL(C415001,0)+NVL(C421015,0)+NVL(C441001,0)+NVL(C421029,0)+NVL(C462001,0)+NVL(C462034,0))    DCR_VF_CELL_DENOM,
SUM(C409038+C410008+C414038+NVL(C415001,0)+NVL(C421015,0)+NVL(C441001,0)+NVL(C421029,0)+NVL(C462001,0)+NVL(C462034,0))    DCR_VF_BSS_DENOM,
SUM(C409098+C409042+C410068+C410012+C414085+C414042)    CSTCHB_VF_NUM,
SUM(C427004)    PACASSFAILR_VF_DENOM,
SUM(NVL(C461001,0)+NVL(C462001,0)+NVL(C462034,0)+NVL(C416001,0))    PHOSUC_VF_NUM,
SUM(NVL(C461011,0)+NVL(C462012,0)+NVL(C462044,0)+NVL(C416011,0))    PHOSUC_VF_DENOM,
SUM(NVL(C461013,0)+NVL(C462019,0)+NVL(C462051,0)+NVL(C416018,0))    PHOFAILURE_VF_NUM,

SUM(C543054+C543055+C543056+C543057+C543058+C543059+C543060+C543061+C543062+C543063+C543064+C543065+C543066+C543067+C543068+C543069+C543070+C543071+C543072+C543073+C543074+C543075+C543076+C543077+C543078+C543079+C543080+C543081+C543082+C543083+C543084+C543085+C543086+C543087+C543088+C543089+C543090+C543091+C543092+C543093+C543094+C543095+C543096+C543097 +C543010 +C543011+ C543012+C543013+C543014+C543015+C543016+C543017+C543018+C543019+C543020+C543021+C543022+C543023 +C543024+C543025+C543026+C543027+C543028+C543029+C543030+C543031+C543032+C543033+C543034+C543035+C543036+C543037+C543038+C543039+C543040+C543041+C543042+C543043+C543044+C543045+C543046+C543047+C543048+C543049+C543050+C543051+C543052+C543053)    UL_QUAL_FER_DEN,
SUM(C543054+C543055+C543056+C543057+C543058+C543059+C543060+C543061+C543062+C543063+C543064+C543065+C543066+C543067+C543068+C543069+C543070+C543071+C543072+C543073+C543074+C543075+C543076+C543077+C543078+C543079+C543080+C543081+C543082+C543083+C543084+C543085+C543086+C543087+C543088+C543089+C543090+C543091+C543092+C543093+C543094+C543095+C543096+C543097)    UL_QUAL_FER_NUM,
NVL(SUM(CCH_BS_T200+CCH_BS_UNSOL_DM_RESP+CCH_BS_SEQ_ERR+CCH_BS_DIST+CCH_BS_LINK_FAIL),0)    CCH_RFLOSSES,

NVL(SUM(TCH_BS_INIT_REL_T200+TCH_BS_INIT_REL_UNSOL_DM_RESP+TCH_BS_INIT_REL_SEQ_ERR+TCH_BS_INIT_REL_DIST+TCH_BS_LINK_FAIL+TCH_BS_INTRA_CELL_FAIL+TCH_BS_INTER_CELL_FAIL+TCH_BS_INTER_BSC_FAIL),0)   DCR_VF_NUM,

SUM(C546000-C546000) CELL_AVAIL,
TRUNC(A.DATA_DATE,'HH24')    FRAGMENT_DATE
FROM
NORTHI_PARSER.SAM2G_STAT_CS_CALL_SETUP_MO A LEFT OUTER JOIN  NORTHI_PARSER.SAM2G_STAT_CS_REEST B ON (A.NETWORK_ID=B.NETWORK_ID AND A.DATA_DATE=B.DATA_DATE)
LEFT OUTER JOIN NORTHI_PARSER.SAM2G_STAT_SMS_MT C ON (A.NETWORK_ID=C.NETWORK_ID AND A.DATA_DATE=C.DATA_DATE)
LEFT OUTER JOIN NORTHI_PARSER.SAM2G_STAT_CHNL_REQ D ON (A.NETWORK_ID=D.NETWORK_ID AND A.DATA_DATE=D.DATA_DATE)
LEFT OUTER JOIN NORTHI_PARSER.SAM2G_STAT_CS_CALL_SETUP_MT E ON (A.NETWORK_ID=E.NETWORK_ID AND A.DATA_DATE=E.DATA_DATE)
LEFT OUTER JOIN NORTHI_PARSER.SAM2G_STAT_CHNL_REQ_TCH F ON (A.NETWORK_ID=F.NETWORK_ID AND A.DATA_DATE=F.DATA_DATE)
LEFT OUTER JOIN NORTHI_PARSER.SAM2G_STAT_ADMIT_CTRL G ON (A.NETWORK_ID=G.NETWORK_ID AND A.DATA_DATE=G.DATA_DATE)
LEFT OUTER JOIN NORTHI_PARSER.SAM2G_STAT_SENT_PAGING H ON (A.NETWORK_ID=H.NETWORK_ID AND A.DATA_DATE=H.DATA_DATE)
LEFT OUTER JOIN NORTHI_PARSER.SAM2G_STAT_PERFORMANCE_EMR I ON (A.NETWORK_ID=I.NETWORK_ID AND A.DATA_DATE=I.DATA_DATE)
LEFT OUTER JOIN NORTHI_PARSER.SAM2G_STAT_SPEECH_CODEC_TYPE J ON (A.NETWORK_ID=J.NETWORK_ID AND A.DATA_DATE=J.DATA_DATE)
LEFT OUTER JOIN NORTHI_PARSER.SAM2G_STAT_CCCH K ON (A.NETWORK_ID=K.NETWORK_ID AND A.DATA_DATE=K.DATA_DATE)
LEFT OUTER JOIN NORTHI_PARSER.SAM2G_STAT_PCU_CELL L ON (A.NETWORK_ID=L.NETWORK_ID AND A.DATA_DATE=L.DATA_DATE)
---LEFT OUTER JOIN NORTHI_PARSER.SAM2G_STT_HO_INTR_BSC_GERN_OUT M ON (A.NETWORK_ID=M.NETWORK_ID AND A.DATA_DATE=M.DATA_DATE)
LEFT OUTER JOIN (SELECT NETWORK_ID,DATA_DATE, SUM(C416011) C416011,SUM(C416018)C416018, SUM(C416001)C416001 FROM NORTHI_PARSER.SAM2G_STT_HO_INTR_BSC_GERN_OUT M
WHERE DATA_DATE BETWEEN TRUNC(XDATA_DATE,'HH24') AND TRUNC(XDATA_DATE,'HH24')+0.8/24
GROUP BY NETWORK_ID,DATA_DATE ) M ON (A.NETWORK_ID=M.NETWORK_ID AND A.DATA_DATE=M.DATA_DATE)  
--LEFT OUTER JOIN NORTHI_PARSER.SAM2G_STAT_HO_GERAN_INTRA_CELL N ON (A.NETWORK_ID=N.NETWORK_ID AND A.DATA_DATE=N.DATA_DATE)
LEFT OUTER JOIN (SELECT NETWORK_ID,DATA_DATE,SUM(C461011) C461011, SUM(C461013)C461013, SUM(C461001)C461001 FROM NORTHI_PARSER.SAM2G_STAT_HO_GERAN_INTRA_CELL 
WHERE DATA_DATE BETWEEN TRUNC(XDATA_DATE,'HH24') AND TRUNC(XDATA_DATE,'HH24')+0.8/24
GROUP BY NETWORK_ID,DATA_DATE ) N ON (A.NETWORK_ID=N.NETWORK_ID AND A.DATA_DATE=N.DATA_DATE)

--LEFT OUTER JOIN NORTHI_PARSER.SAM2G_STAT_HO_GERAN_INTER_CELL O ON (A.NETWORK_ID=O.NETWORK_ID AND A.DATA_DATE=O.DATA_DATE)
LEFT OUTER JOIN (SELECT NETWORK_ID,DATA_DATE, SUM(C462044) C462044,SUM(C462051)C462051, SUM(C462034)C462034 ,
SUM(C462012) C462012,SUM(C462019)C462019, SUM(C462001)C462001 FROM NORTHI_PARSER.SAM2G_STAT_HO_GERAN_INTER_CELL O
WHERE DATA_DATE BETWEEN TRUNC(XDATA_DATE,'HH24') AND TRUNC(XDATA_DATE,'HH24')+0.8/24
GROUP BY NETWORK_ID,DATA_DATE ) O ON (A.NETWORK_ID=O.NETWORK_ID AND A.DATA_DATE=O.DATA_DATE) 
LEFT OUTER JOIN (SELECT  DATA_DATE,NETWORK_ID,
SUM(Decode(EX_CHANNEL_TYPE||'_'||EX_CAUSE_NAME,'C_SDCCH_BS_INIT_REL_T200',C412000,0)) CCH_BS_T200,
SUM(Decode(EX_CHANNEL_TYPE||'_'||EX_CAUSE_NAME,'C_SDCCH_BS_INIT_REL_UNSOL_DM_RESP',C412000,0)) CCH_BS_UNSOL_DM_RESP ,
SUM(Decode(EX_CHANNEL_TYPE||'_'||EX_CAUSE_NAME,'C_SDCCH_BS_INIT_REL_SEQ_ERROR',C412000,0)) CCH_BS_SEQ_ERR ,
SUM(Decode(EX_CHANNEL_TYPE||'_'||EX_CAUSE_NAME,'C_SDCCH_BS_INIT_REL_DIST',C412000,0)) CCH_BS_DIST ,
SUM(Decode(EX_CHANNEL_TYPE||'_'||EX_CAUSE_NAME,'C_SDCCH_BS_INIT_REL_LINK_FAILURE',C412000,0)) CCH_BS_LINK_FAIL,
SUM(Decode(EX_CHANNEL_TYPE||'_'||EX_CAUSE_NAME,'C_TCH_BS_INIT_REL_T200',C412000,0)) TCH_BS_INIT_REL_T200,
SUM(Decode(EX_CHANNEL_TYPE||'_'||EX_CAUSE_NAME,'C_TCH_BS_INIT_REL_UNSOL_DM_RESP',C412000,0)) TCH_BS_INIT_REL_UNSOL_DM_RESP ,
SUM(Decode(EX_CHANNEL_TYPE||'_'||EX_CAUSE_NAME,'C_TCH_BS_INIT_REL_SEQ_ERROR',C412000,0)) TCH_BS_INIT_REL_SEQ_ERR ,
SUM(Decode(EX_CHANNEL_TYPE||'_'||EX_CAUSE_NAME,'C_TCH_BS_INIT_REL_DIST',C412000,0)) TCH_BS_INIT_REL_DIST ,
SUM(Decode(EX_CHANNEL_TYPE||'_'||EX_CAUSE_NAME,'C_TCH_BS_INIT_REL_LINK_FAILURE',C412000,0)) TCH_BS_LINK_FAIL,
SUM(Decode(EX_CHANNEL_TYPE||'_'||EX_CAUSE_NAME,'C_TCH_BS_INIT_REL_INTRA_CELL_FAILURE',C412000,0)) TCH_BS_INTRA_CELL_FAIL,  
SUM(Decode(EX_CHANNEL_TYPE||'_'||EX_CAUSE_NAME,'C_TCH_BS_INIT_REL_INTER_CELL_FAILURE',C412000,0)) TCH_BS_INTER_CELL_FAIL, 
SUM(Decode(EX_CHANNEL_TYPE||'_'||EX_CAUSE_NAME,'C_TCH_BS_INIT_REL_INTER_BSC_FAILURE',C412000,0)) TCH_BS_INTER_BSC_FAIL 
FROM NORTHI_PARSER.SAM2G_STAT_CS_CALL_REL_BS
WHERE DATA_DATE BETWEEN TRUNC(XDATA_DATE,'HH24') AND TRUNC(XDATA_DATE,'HH24')+0.8/24
GROUP BY DATA_DATE,NETWORK_ID
) P ON (A.NETWORK_ID=P.NETWORK_ID AND A.DATA_DATE=P.DATA_DATE)
--LEFT OUTER JOIN NORTHI_PARSER.SAM2G_STAT_HO_INTER_BSC_GRN_IN R ON (A.NETWORK_ID=R.NETWORK_ID AND A.DATA_DATE=R.DATA_DATE)
LEFT OUTER JOIN (SELECT NETWORK_ID,DATA_DATE, SUM(C415001) C415001 FROM NORTHI_PARSER.SAM2G_STAT_HO_INTER_BSC_GRN_IN R
WHERE DATA_DATE BETWEEN TRUNC(XDATA_DATE,'HH24') AND TRUNC(XDATA_DATE,'HH24')+0.8/24
GROUP BY NETWORK_ID,DATA_DATE ) R ON (A.NETWORK_ID=R.NETWORK_ID AND A.DATA_DATE=R.DATA_DATE)
--LEFT OUTER JOIN NORTHI_PARSER.SAM2G_STAT_HO_INTER_UNID_IN S ON (A.NETWORK_ID=S.NETWORK_ID AND A.DATA_DATE=S.DATA_DATE)
LEFT OUTER JOIN (SELECT NETWORK_ID,DATA_DATE, SUM(C421015) C421015,SUM(C421029)C421029 FROM NORTHI_PARSER.SAM2G_STAT_HO_INTER_UNID_IN S
WHERE DATA_DATE BETWEEN TRUNC(XDATA_DATE,'HH24') AND TRUNC(XDATA_DATE,'HH24')+0.8/24
GROUP BY NETWORK_ID,DATA_DATE ) S ON (A.NETWORK_ID=S.NETWORK_ID AND A.DATA_DATE=S.DATA_DATE) 
--LEFT OUTER JOIN NORTHI_PARSER.SAM2G_HO_NTR_RT_UTRN_IN_TO_GRN T ON (A.NETWORK_ID=T.NETWORK_ID AND A.DATA_DATE=T.DATA_DATE)
LEFT OUTER JOIN (SELECT NETWORK_ID,DATA_DATE, SUM(C441001) C441001 FROM NORTHI_PARSER.SAM2G_HO_NTR_RT_UTRN_IN_TO_GRN T
WHERE DATA_DATE BETWEEN TRUNC(XDATA_DATE,'HH24') AND TRUNC(XDATA_DATE,'HH24')+0.8/24
GROUP BY NETWORK_ID,DATA_DATE ) T ON (A.NETWORK_ID=T.NETWORK_ID AND A.DATA_DATE=T.DATA_DATE)
LEFT OUTER JOIN NORTHI_PARSER.SAM2G_STAT_GSM_CELL_UNAV U ON (A.NETWORK_ID=U.NETWORK_ID AND A.DATA_DATE=U.DATA_DATE)
WHERE
A.DATA_DATE BETWEEN TRUNC(XDATA_DATE,'HH24') AND TRUNC(XDATA_DATE,'HH24')+0.8/24
GROUP BY A.NETWORK_ID,TRUNC(A.DATA_DATE,'HH24'); 

XREC_COUNT:=SQL%ROWCOUNT; 

COMMIT;

END; 
/
