
  CREATE OR REPLACE EDITIONABLE PROCEDURE "NORTHI_LOADER"."CREATE_PARTITION_BH" 
AS
XEND_DATE DATE;
BEGIN

XEND_DATE:=ADD_MONTHS(TRUNC(SYSDATE,'MONTH'),2);


       FOR XPRT IN (
            SELECT REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(TABLE_NAME,'DBH_'),'MBH5_'),'MBH7_'),'WBH5_'),'WBH7_') ORG_TABLE,TABLE_NAME,MAX(DATA_DATE)+1 DATA_DATE
            FROM NORTHI_TABLE_PARTITION_LIST
            WHERE TABLE_NAME IN 
            (
            'DBH_CELL_STATISTICS','DBH_CELLGPRS','DBH_CELLSTS','DBH_GBL','DBH_RNC_STATISTICS','MBH5_CELLGPRS','MBH5_CELLSTS','MBH5_GBL','MBH5_RNC_STATISTICS',
            'MBH7_CELLGPRS','MBH7_CELLSTS','MBH7_GBL','MBH7_RNC_STATISTICS','NORTHI_TABLE_BH_FIELDS','WBH5_CELL_STATISTICS','WBH5_CELLGPRS','WBH5_CELLSTS','WBH5_GBL','WBH5_RNC_STATISTICS',
            'WBH7_CELL_STATISTICS','WBH7_CELLGPRS','WBH7_CELLSTS','WBH7_GBL','WBH7_RNC_STATISTICS','DBH_SPU_STATISTICS','DBH_INT_STATISTICS','DBH_DSP_STATISTICS','DBH_DPU_STATISTICS','DBH_NWSTS','DBH_FEMTOSTS',
            'DBH_LCELL_STATISTICS',
            
'WBH5_SPU_STATISTICS','WBH5_INT_STATISTICS','WBH5_DSP_STATISTICS','WBH5_DPU_STATISTICS','WBH5_NWSTS','WBH5_FEMTOSTS','WBH5_LCELL_STATISTICS',
'WBH7_SPU_STATISTICS','WBH7_INT_STATISTICS','WBH7_DSP_STATISTICS','WBH7_DPU_STATISTICS','WBH7_NWSTS','WBH7_FEMTOSTS','WBH7_LCELL_STATISTICS',
'MBH5_SPU_STATISTICS','MBH5_INT_STATISTICS','MBH5_DSP_STATISTICS','MBH5_DPU_STATISTICS','MBH5_NWSTS','MBH5_FEMTOSTS','MBH5_LCELL_STATISTICS',
'MBH7_SPU_STATISTICS','MBH7_INT_STATISTICS','MBH7_DSP_STATISTICS','MBH7_DPU_STATISTICS','MBH7_NWSTS','MBH7_FEMTOSTS','MBH7_LCELL_STATISTICS',
'DBH_NODEB_STATISTICS','WBH5_NODEB_STATISTICS','WBH7_NODEB_STATISTICS','MBH5_NODEB_STATISTICS','MBH7_NODEB_STATISTICS'

            )  -- 'MBH5_CELL_STATISTICS' , 'MBH7_CELL_STATISTICS'
            GROUP BY TABLE_NAME
        )
        LOOP
            IF INSTR(XPRT.TABLE_NAME,'DBH')>0 THEN
                BH_CREATION.ADD_BH_TABLE_PARTITION('NORTHI_DATA.'||XPRT.TABLE_NAME,XPRT.ORG_TABLE,XPRT.DATA_DATE,XEND_DATE,1);
            ELSE
                BH_CREATION.ADD_BH_TABLE_PARTITION('NORTHI_DATA.'||XPRT.TABLE_NAME, XPRT.ORG_TABLE,XPRT.DATA_DATE,XEND_DATE,7);
            END IF;
        END LOOP;
END; 
/
