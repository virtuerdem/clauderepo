
  CREATE OR REPLACE EDITIONABLE PROCEDURE "NORTHI_LOADER"."RE_CALC_RNC" 
AS
XDATe DATE;
BEGIN
    XDATE:=TO_DATE('01.07.2011 00','DD.MM.YYYY HH24');
    WHILE XDATE<TO_DATE('15.07.2011 00','DD.MM.YYYY HH24') LOOP
        DELETE FROM NORTHI_dATA.RNC_STATISTICS WHERE FRAGMENT_DATE=XDATE;
        DELETE FROM NORTHI_TABLE_LOGS WHERE FRAGMENT_DATE=XDATE AND TABLE_NAME ='RNC_STATISTICS';
        COMMIT;
        UPDATE NORTHI_LOADER_PROCESS SET DAILY_STATE=0 WHERE ORG_TABLE='RNC_STATISTICS' AND DATA_DATE=XDATE;
        COMMIT;
        P_RNC_STATISTICS_rnc_SIL(XDATE);
        P_RNC_STATISTICS_NW(XDATE);
        XDATE:=XDATE+1/24;
    END LOOP;
    
    WHILE XDATE<SYSDATE LOOP
        DELETE FROM NORTHI_dATA.RNC_STATISTICS WHERE FRAGMENT_DATE=XDATE;
        DELETE FROM NORTHI_TABLE_LOGS WHERE FRAGMENT_DATE=XDATE AND TABLE_NAME ='RNC_STATISTICS';
        COMMIT;
        UPDATE NORTHI_LOADER_PROCESS SET DAILY_STATE=0,loader_count=2 WHERE ORG_TABLE='RNC_STATISTICS' AND DATA_DATE=XDATE;
        COMMIT;
        P_RNC_STATISTICS_rnc(XDATE);
        P_RNC_STATISTICS_NW(XDATE);
        XDATE:=XDATE+1/24;
    END LOOP;
    
END;
/
